{"version":3,"sources":["bootstrap.ts","formation/PlanePosition.ts","drawing/AbstractDrawer.ts","store/types.ts","constants.ts","geometry/Polar.ts","geometry/Box.ts","drawing/planedrawers.ts","drawing/slotdatafuns.ts","drawing/PlanesDrawer.ts","drawing/FormationDrawer.ts","components/FormationComponent.tsx","util/approxeq.ts","formation/lapwrapper.ts","formation/lap.js","formation/slotify.ts","formation/buildSlots.ts","formation/components/Component.ts","formation/components/Round.ts","formation/components/Whacker.ts","formation/components/Base.ts","formation/AbstractSlotCollection.ts","formation/buildFormation.ts","selectors/getSlotOptions.ts","formation/planes.ts","formation/buildPlanes.ts","selectors/index.ts","formation/planeify.ts","components/FormationContainer.ts","components/config/PanelContext.tsx","components/config/Select.tsx","components/config/SettingsPanel.tsx","components/config/Slots.tsx","store/actions.ts","components/config/Planes.tsx","components/config/View.tsx","components/config/Panels.tsx","components/config/ConfigDrawer.tsx","serviceWorker.js","store/reducer.ts","store/configureStore.ts","index.tsx","components/App.tsx"],"names":["install","PlanePosition","AbstractDrawer","group","this","Slotting","PlaneType","ColorOption","NumberOption","ShowOption","FormationType","PI","Math","TAU","Polar","radius","theta","Object","classCallCheck","unspin","concat","other","r1","t1","r2","t2","sqrt","cos","atan2","sin","plus","rotate","over","minus","s","floor","Box","x0","y0","x1","y1","createClass","key","value","p","min","x","y","max","b","get","PLANE_SCALE_FACTOR","positionLabels","_positionLabels","defineProperty","LEAD","LT","RT","w","l","line","d3","d","OtterDrawer","_this","otterPoints","doorPoints","slotCoords","toConsumableArray","map","flatMap","planeSlotId","box","scale","g","append","attr","text","plane","position","SkyvanDrawer","_this2","skyvanPoints","redLine","style","planeDrawers","_planeDrawers","OTTER","SKYVAN","buildOrderFill","_ref","stop","buildOrder","formationSlot","domain","toString","planeFill","filter","_","i","includes","radialFill","_ref2","offset","fillFunction","colorBy","BUILD_ORDER","PLANE","RADIAL","labelFunction","numberBy","SLOT_NUM_BY_PLANE","byPlaneSlotId","formationSlotId","scaledCoord","point","type","HD","flip","scaledPosition","_ref3","formation","scaledOffset","_ref4","arc","scaledPos","dockAngle","outerRadius","innerRadius","startAngle","d3theta","endAngle","planeX","planeY","highlight","transition","ease","overshoot","unhighlight","addSlot","fill","label","classed","on","call","slotG","circle","updateSlot","select","transitionOut","exit","t","remove","PlanesDrawer","args","p2c","planes","show","viewConfig","_ref$formation","FORMATION","PLANES","positions","Map","idx","all","length","abs","BOTH","coord","planeCoordinates","labelCoord","_ref3$formation","labelPosition","slotsByPlane","Array","from","d3Group","slots","_ref5","slicedToArray","slotData","_ref6","dummyFormationSlot","reverseBuildOrder","videoSlot","planeId","videoId","hasVideo","selectAll","data","join","enter","each","_ref7","nodes","draw","undefined","_ref8","selection","baseIds","planeLabel","labelBox","update","HD_ABOVE","HU","translate","drawLabel","reduce","_ref9","union","FormationDrawer","flipX","FormationComponent","svg","allGrp","wrapper","zoom","formationDrawer","planesDrawer","parseInt","scaleExtent","transform","translateBy","width","height","duration","withGroup","formationBox","props","planeBox","zoomToBox","cx","cy","_this3","react_default","a","createElement","ref","element","React","Component","approxeq","eps","arguments","Number","EPSILON","combineScoreFuns","_len","funs","_key","fallback","val","fun","lapwrapper","as","bs","scoreFun","Error","badScores","score","Infinity","console","warn","result","dim","cost","cost_matrix","j","i1","j1","sum","unassignedfound","imin","prvnumfree","f","i0","k","freerow","j2","endofpath","last","low","up","h","umin","usubmin","v2","BIG","epsilon","rowsol","Int32Array","colsol","u","Float64Array","v","numfree","free","collist","matches","pred","loopcnt","lapcost","row","col","lap","memo","has","set","slice","every","r","Set","size","allScores","error","slotPlane","formationSlotIds","specialSlotScore","slot","jr","slotJr","filledSlots","baseIdIndex","findIndex","id","baseSize","slotNumOffset","checkSlot","slotPosition","waiting","range","pos","rotation","apply","parents","parent","maxBuildOrder","Round","left","right","possibleConstructorReturn","getPrototypeOf","firstRun","_prrd","c","prrd","ceil","_positionRadiusRotationDockAngle","dockPosition","leftDockPosition","rightDockPosition","dockDistance","distanceFrom","_Round$__computeRadiu","__computeRadiusTheta","angleDelta","angleTo","iters","iter","lower","upper","mid","ss","Whacker","dock","hand","_this$dock","_this$dock2","psuedoSlots","_left","_right","invisibleSlots","_this$_prrd","fixedRotation","Base","_rotation","AbstractSlotCollection","_slots","computeSlots","slotsInRing","ring","podLines","round","bridges","addRings","rings","completeRings","nextRingSlots","dockPositions","base","component","isPod","firstPods","numBridges","bridgeNum","secondPods","bridgeSecondPods","secondPod","nextDockPositions","slotGroups","slotsPerGroup","groupsWithExtraSlot","nextRing","groupNum","slotsToFill","totalSlotsInGroup","priorSlots","leftHandSlots","rightHandSlots","whackers","push","FormationImpl","components","allSlots","adjustedSlot","objectSpread","parentToChildren","child","forEach","componentToWaiting","children","numWaiting","find","slotRadi","expand","createSelector","state","formationConfig","planesConfig","_planesConfig$filter$","NONE","slotting","planeMin","FILL","planeMax","fixedMin","PlaneImpl","_AbstractSlotCollecti","hasSuperFloat","inherits","reverse","countFilledSlots","filledPlanes","_ref10","_ref11","slotUnfilledPlanes","unfilledPlanes","slotsRemaining","slotsPerPlane","lead","littlePlanes","littlePlaneLabels","minSlotsPerPlane","extras","filledLead","remainingFilled","_ref12","getSlots","getSlotOptions","getBaseSize","getFormation","flat","getPlanes","slotsMap","_ref13","_ref14","getAllSlots","planeAssignments","slotted","unslotted","planeArray","slotId","diff","componentTheta","componentPosition","penalty","slotIds","planeify","planeSlotAssignments","slotify","planeIdToSortedFormationSlotIds","d3Rollup","pa","sort","formationSlotIdToByPlaneSlotId","acc","connect","createContext","expanded","setExpanded","useStyles","makeStyles","theme","root","margin","spacing","unit","minWidth","Select","onSet","opts","desc","classes","core_index_es","className","onChange","e","target","native","isMobile","opt","makeOpts","heading","fontSize","typography","pxToRem","flexBasis","flexShrink","secondaryHeading","color","palette","secondary","form","display","flexWrap","formControl","SettingsPanel","name","heading1","heading2","_useContext","useContext","PanelContext","ExpansionPanel_default","event","isExpanded","square","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","Typography_default","ExpansionPanelDetails_default","autoComplete","alignItems","slider","paddingLeft","paddingRight","formationTypeDesc","_formationTypeDesc","slotsOptions","formationType","dispatch","onFormationSlotsSet","formationSlots","onBaseSizeSet","onSetFormationType","_props$slotsOptions","slotItems","formationTypes","slotForm","variant","gutterBottom","Slider_default","step","Fragment","config_SettingsPanel","typeDescriptions","_typeDescriptions","PlaneMenu","_slottingDescriptions","planeConfig","setters","onPlaneSlottingSet","onPlaneTypeSet","onPlaneSlotsSet","onPlaneVideoSet","types","SPLIT","slottingDescriptions","slottings","control","checked","planeType","setPlaneType","setPlaneSlots","setPlaneSlotting","setPlaneVideo","Planes_PlaneMenu","colorBys","DEFAULT","colorByDesc","_colorByDesc","numberBys","SLOT_NUM","numberByDesc","_numberByDesc","showOptions","showOptionDesc","_showOptionDesc","onSetColorBy","setColorBy","onSetNumberBy","setNumberBy","onSetShow","setShow","Panels","_React$useState","useState","_React$useState2","Provider","config_Slots","config_Planes","config_View","drawer","breakpoints","appBar","marginLeft","menuButton","marginRight","toolbar","mixins","drawerPaper","flexGrow","content","flexDirection","onRefreshState","mobileOpen","setMobileOpen","handleDrawerToggle","AppBar_default","Toolbar_default","IconButton_default","aria-label","onClick","Menu_default","noWrap","Refresh_default","Hidden_default","smUp","implementation","SwipeableDrawer_default","open","onOpen","onClose","paper","ModalProps","keepMounted","xsDown","Drawer_default","Boolean","window","location","hostname","match","initialPlaneState","rootReducer","combineReducers","action","refreshingReducer","storageReduxer","storage","reducer","engine","createEngine","middleware","store","createStore","composeWithDevTools","applyMiddleware","createMuiTheme","useNextVariants","ReactDOM","render","es","CssBaseline_default","index_es","config_ConfigDrawer","FormationContainer","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.f1f181f7.chunk.js","sourcesContent":["import { install } from \"@material-ui/styles\"\n\ninstall()\n","enum PlanePosition {\n    LEAD='lead',\n    LT = 'lt',\n    RT = 'rt'\n}\n\nexport default PlanePosition","import { Drawer } from \"./interfaces\"\n\nexport default abstract class AbstractDrawer<Args, ReturnArgs>\n  implements Drawer<Args, ReturnArgs> {\n  group!: d3.Selection<SVGGElement, {}, null, undefined>\n\n  withGroup(group: d3.Selection<SVGGElement, {}, null, undefined>): this {\n    this.group = group\n    return this\n  }\n\n  abstract draw(args: Args, transition: any): ReturnArgs\n}\n","import PlanePosition from \"../formation/PlanePosition\"\n\nexport enum Slotting {\n  SPLIT,\n  FILL\n}\n\nexport enum PlaneType {\n  NONE,\n  OTTER,\n  SKYVAN\n}\n\nexport enum ColorOption {\n  DEFAULT,\n  PLANE,\n  BUILD_ORDER,\n  RADIAL\n}\n\nexport enum NumberOption {\n  SLOT_NUM,\n  SLOT_NUM_BY_PLANE,\n  BUILD_ORDER\n}\n\nexport enum ShowOption {\n  FORMATION,\n  PLANES,\n  BOTH\n}\n\nexport enum FormationType {\n  HD,\n  HD_ABOVE,\n  HU\n}\n\nexport interface PlaneState {\n  position: PlanePosition\n  label: string\n  slotting: Slotting\n  type: PlaneType\n  slots: number\n  hasVideo: boolean\n  hasSuperFloat: boolean\n}\n\nexport interface FormationConfigState {\n  slots: number\n  baseSize: number\n  type: FormationType\n}\n\nexport interface ViewConfigState {\n  colorBy: ColorOption\n  numberBy: NumberOption\n  show: ShowOption\n}\n\nexport const SET_PLANE_SLOTTING = \"SET_PLANE_SLOTTING\"\ninterface SetPlaneSlottingAction {\n  type: typeof SET_PLANE_SLOTTING\n  position: PlanePosition\n  slotting: Slotting\n}\n\nexport const SET_PLANE_TYPE = \"SET_PLANE_TYPE\"\ninterface SetPlaneTypeAction {\n  type: typeof SET_PLANE_TYPE\n  position: PlanePosition\n  planeType: PlaneType\n}\n\nexport const SET_PLANE_SLOTS = \"SET_PLANE_SLOTS\"\ninterface SetPlaneSlotsAction {\n  type: typeof SET_PLANE_SLOTS\n  position: PlanePosition\n  slots: number\n}\n\nexport const SET_PLANE_VIDEO = \"SET_PLANE_VIDEO\"\ninterface SetPlaneVideoAction {\n  type: typeof SET_PLANE_VIDEO\n  position: PlanePosition\n  hasVideo: boolean\n}\nexport type PlanesConfigActionTypes =\n  | SetPlaneSlottingAction\n  | SetPlaneTypeAction\n  | SetPlaneSlotsAction\n  | SetPlaneVideoAction\n\nexport const SET_FORMATION_SLOTS = \"SET_FORMATION_SLOTS\"\ninterface SetFormationSlotsAction {\n  type: typeof SET_FORMATION_SLOTS\n  slots: number\n}\nexport const SET_FORMATION_TYPE = \"SET_FORMATION_TYPE\"\ninterface SetFormationTypeAction {\n  type: typeof SET_FORMATION_TYPE\n  formationType: FormationType\n}\nexport const SET_BASE_SIZE = \"SET_BASE_SIZE\"\ninterface SetBaseSizeAction {\n  type: typeof SET_BASE_SIZE\n  baseSize: number\n}\nexport type FormationConfigActionTypes =\n  | SetFormationSlotsAction\n  | SetFormationTypeAction\n  | SetBaseSizeAction\n\nexport const SET_COLOR_BY = \"SET_COLOR_BY\"\ninterface SetColorByAction {\n  type: typeof SET_COLOR_BY\n  colorBy: ColorOption\n}\nexport const SET_NUMBER_BY = \"SET_NUMBER_BY\"\ninterface SetNumberByAction {\n  type: typeof SET_NUMBER_BY\n  numberBy: NumberOption\n}\n\nexport const SET_SHOW = \"SET_SHOW\"\ninterface SetShowAction {\n  type: typeof SET_SHOW\n  show: ShowOption\n}\nexport type ViewConfigActionTypes =\n  | SetColorByAction\n  | SetNumberByAction\n  | SetShowAction\n\nexport const REFRESH_STATE = \"REFRESH_STATE\"\nexport interface RefreshStateAction {\n  type: typeof REFRESH_STATE\n}\n","export const PI = Math.PI\nexport const TAU = 2 * PI\nexport const SCALE_FACTOR = 80\n","import { PI, TAU } from \"../constants\"\n\n// polar coordinate from origin (center of base)\nexport default class Polar {\n  radius: number\n  theta: number\n  constructor(radius: number, theta: number) {\n    this.radius = radius\n    this.theta = Polar.unspin(theta)\n  }\n\n  toString() {\n    return `(r${this.radius},∠${this.theta / TAU}τ)`\n  }\n\n  //https://math.stackexchange.com/questions/1365622/adding-two-polar-vectors\n  plus(other: Polar) {\n    const { radius: r1, theta: t1 } = this\n    const { radius: r2, theta: t2 } = other\n    return new Polar(\n      Math.sqrt(r1 * r1 + r2 * r2 + 2 * r1 * r2 * Math.cos(t2 - t1)),\n      t1 + Math.atan2(r2 * Math.sin(t2 - t1), r1 + r2 * Math.cos(t2 - t1))\n    )\n  }\n\n  minus(other: Polar) {\n    return this.plus(other.rotate(PI))\n  }\n\n  rotate(theta: number) {\n    return new Polar(this.radius, this.theta + theta)\n  }\n\n  //flip coordinate over over\n  flip(over: number) {\n    return new Polar(this.radius, -this.theta - 2 * over)\n  }\n\n  // distance from other point\n  distanceFrom(other: Polar) {\n    return this.minus(other).radius\n  }\n\n  angleFrom(other: Polar) {\n    return this.minus(other).theta\n  }\n\n  angleTo(other: Polar) {\n    return other.minus(this).theta\n  }\n\n  scale(s: number) {\n    return new Polar(this.radius * s, this.theta)\n  }\n\n  // d3 treats theta = 0 as up, but in high school, theta = 0 is right\n  // also, d3 treats increasing theta as rotating clockwise, hs went counter clock wise\n  // this maps a highschool polar angle to a d3 polar angle\n  get d3theta() {\n    return Polar.unspin(-this.theta + PI / 2)\n  }\n\n  get x() {\n    return this.radius * Math.cos(this.theta)\n  }\n\n  //svg treats positive y as going down from top of page\n  get y() {\n    return -this.radius * Math.sin(this.theta)\n  }\n\n  // map theta back to [0, 2PI)\n  static unspin(theta: number) {\n    const t = Math.floor(theta / (2 * PI))\n    return theta - t * 2 * PI\n  }\n}\n","import Polar from \"./Polar\"\n\nexport class Box {\n  x0: number\n  y0: number\n  x1: number\n  y1: number\n  constructor(x0: number, y0: number, x1: number, y1: number) {\n    this.x0 = x0\n    this.y0 = y0\n    this.x1 = x1\n    this.y1 = y1\n  }\n\n  get cx(): number {\n    return (this.x0 + this.x1) / 2\n  }\n  get cy(): number {\n    return (this.y0 + this.y1) / 2\n  }\n\n  get width(): number {\n    return this.x1 - this.x0\n  }\n\n  get height(): number {\n    return this.y1 - this.y0\n  }\n\n  //since browser/d3 coordinates flip Y\n  flipY(): Box {\n    return new Box(this.x0, -this.y1, this.x1, -this.y0)\n  }\n\n  flipX(): Box {\n    return new Box(-this.x1, this.y0, -this.x0, this.y1)\n  }\n\n  expand(p: Polar): Box {\n    return new Box(\n      Math.min(this.x0, p.x),\n      Math.min(this.y0, p.y),\n      Math.max(this.x1, p.x),\n      Math.max(this.y1, p.y)\n    )\n  }\n\n  translate(p: Polar): Box {\n    return new Box(this.x0 + p.x, this.y0 + p.y, this.x1 + p.x, this.y1 + p.y)\n  }\n\n  union(b: Box): Box {\n    return new Box(\n      Math.min(this.x0, b.x0),\n      Math.min(this.y0, b.y0),\n      Math.max(this.x1, b.x1),\n      Math.max(this.y1, b.y1)\n    )\n  }\n\n  scale(s: number): Box {\n    return new Box(this.x0 * s, this.y0 * s, this.x1 * s, this.y1 * s)\n  }\n}\n","import { PlaneDrawer, SlottedPlane } from \"./interfaces\"\nimport * as d3 from \"d3\"\nimport { Selection, BaseType } from \"d3\"\nimport PlanePosition from \"../formation/PlanePosition\"\nimport { PlaneType } from \"../store/types\"\nimport { SlotData, NumDict } from \"../formation/interfaces\"\nimport { Box } from \"../geometry/Box\"\n\nexport const PLANE_SCALE_FACTOR = 40\n\ntype XY = {\n  x: number;\n  y: number;\n}\n\nconst positionLabels = {\n  [PlanePosition.LEAD]: \"Lead\",\n  [PlanePosition.LT]: \"Left Trail\",\n  [PlanePosition.RT]: \"Right Trail\"\n}\n\nconst w = 1.5\nconst l = 6.5\n\nexport const line = d3\n  .line<XY>()\n  .x(d => d.x * PLANE_SCALE_FACTOR)\n  .y(d => d.y * PLANE_SCALE_FACTOR)\n\nexport class OtterDrawer implements PlaneDrawer {\n  private otterPoints = [\n    { x: -w, y: -l },\n    { x: w, y: -l },\n    { x: w, y: l },\n    { x: -w, y: l },\n    { x: -w, y: -l }\n  ]\n\n  private doorPoints = [{ x: -w, y: l - 6 }, { x: -w, y: l - 2 }]\n\n  /**\n   *      23 22\n   *      21 20\n   *      19 18\n   *      17 16\n   *      15 14\n   *   6  13 12\n   *   5\n   *   4  9 11\n   *   3  8 10\n   *   2  7\n   *   1\n   *   0\n   */\n  private slotCoords = [\n    //floaters\n    ...d3.range(7).map(y => ({ x: -2, y: 6 - y })),\n    //first row in door\n    ...d3.range(3).map(y => ({ x: -1, y: 3.5 - y })),\n    //2nd row in door\n    ...d3.range(2).map(y => ({ x: 0, y: 3 - y })),\n    //divers\n    ...d3.range(6).flatMap(y => [{ x: 0.5, y: -y }, { x: -0.5, y: -y }])\n  ]\n  draw(g: Selection<SVGGElement, SlottedPlane, BaseType, any>) {\n    g.append(\"path\").attr(\"d\", line(this.otterPoints)!)\n    g.append(\"path\")\n      .attr(\"stroke-width\", 3)\n      .attr(\"d\", line(this.doorPoints)!)\n    g.append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"dominant-baseline\", \"central\")\n      .attr(\"x\", 0)\n      .attr(\"y\", (-l + 0.5) * PLANE_SCALE_FACTOR)\n      .text(d => `${positionLabels[d.plane.position]}`)\n  }\n\n  x = (d: SlotData) => this.slotCoords[d.planeSlotId].x * PLANE_SCALE_FACTOR\n  y = (d: SlotData) => this.slotCoords[d.planeSlotId].y * PLANE_SCALE_FACTOR\n\n  box = new Box(-w - 1, -l, w, l).scale(PLANE_SCALE_FACTOR)\n}\n\nexport class SkyvanDrawer implements PlaneDrawer {\n  private skyvanPoints = [\n    { x: -w, y: -l },\n    { x: w, y: -l },\n    { x: w, y: l },\n    { x: -w, y: l },\n    { x: -w, y: -l }\n  ]\n\n  private doorPoints = [{ x: -w, y: l }, { x: w, y: l }]\n  private redLine = [{ x: -w, y: l - 4 }, { x: w, y: l - 4 }]\n\n  /**\n   *      23\n   *    21  22\n   *    19  20\n   *    17  18\n   *    15  16\n   *    13  14\n   *    11  12\n   *     9  10\n   *   ---------\n   *\n   *   6   7   8\n   *   3   4   5\n   *   0   1   2\n   *\n   */\n  private slotCoords = [\n    //1st row\n    ...d3\n      .range(3)\n      .flatMap(y => [\n        { x: -1, y: 6 - y },\n        { x: 0, y: 6 - y },\n        { x: 1, y: 6 - y }\n      ]),\n    // the rest on back\n    ...d3.range(8).flatMap(y => [{ x: -0.5, y: 2 - y }, { x: 0.5, y: 2 - y }])\n  ]\n  draw(g: Selection<SVGGElement, SlottedPlane, BaseType, any>) {\n    g.append(\"path\").attr(\"d\", line(this.skyvanPoints)!)\n    g.append(\"path\")\n      .attr(\"stroke-width\", 3)\n      .attr(\"d\", line(this.doorPoints)!)\n\n    g.append(\"path\")\n      .attr(\"stroke-width\", 2)\n      .style(\"stroke\", \"red\")\n      .attr(\"d\", line(this.redLine)!)\n    g.append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"dominant-baseline\", \"central\")\n      .attr(\"x\", 0)\n      .attr(\"y\", (-l + 1) * PLANE_SCALE_FACTOR)\n      .text(d => positionLabels[d.plane.position])\n  }\n\n  x = (d: SlotData) => this.slotCoords[d.planeSlotId].x * PLANE_SCALE_FACTOR\n  y = (d: SlotData) => this.slotCoords[d.planeSlotId].y * PLANE_SCALE_FACTOR\n\n  box = new Box(-w, -l, w, l).scale(PLANE_SCALE_FACTOR)\n}\n\nexport const planeDrawers: NumDict<PlaneDrawer> = {\n  [PlaneType.OTTER]: new OtterDrawer(),\n  [PlaneType.SKYVAN]: new SkyvanDrawer()\n}\n","import { SlotData } from \"../formation/interfaces\"\nimport * as d3 from \"d3\"\nimport PlanePosition from \"../formation/PlanePosition\"\nimport { SCALE_FACTOR, TAU, PI } from \"../constants\"\nimport { BaseType } from \"d3\"\nimport { ColorOption, NumberOption, FormationType } from \"../store/types\"\nimport { planeDrawers } from \"./planedrawers\"\nimport Polar from \"../geometry/Polar\"\n\nexport type SlotDataFun = (d: SlotData) => any\n\nconst stringRange = (stop: number): string[] =>\n  d3.range(stop).map(x => x.toString())\n\nconst buildOrderFill = ({ formationSlot: { buildOrder } }: SlotData) =>\n  d3.scaleOrdinal(d3.schemePaired).domain(stringRange(12))(\n    (buildOrder - 1).toString()\n  )\nconst planeFill = (d: SlotData) =>\n  d3\n    .scaleOrdinal(d3.schemePaired.filter((_, i) => [0, 2, 4].includes(i)))\n    .domain([PlanePosition.LEAD, PlanePosition.LT, PlanePosition.RT])(\n    d.plane.position\n  )\n\nconst radialFill = ({ formationSlot }: SlotData) => {\n  const theta = formationSlot.offset.plus(formationSlot.position).theta / TAU\n  return d3.interpolateRainbow(theta)\n}\n\nexport const fillFunction = (colorBy: ColorOption): SlotDataFun => {\n  switch (colorBy) {\n    case ColorOption.BUILD_ORDER:\n      return buildOrderFill\n    case ColorOption.PLANE:\n      return planeFill\n    case ColorOption.RADIAL:\n      return radialFill\n    default:\n      return () => null\n  }\n}\n\nexport const labelFunction = (numberBy: NumberOption) => {\n  switch (numberBy) {\n    case NumberOption.BUILD_ORDER:\n      return (d: SlotData) => d.formationSlot.buildOrder\n    case NumberOption.SLOT_NUM_BY_PLANE:\n      return (d: SlotData) => d.byPlaneSlotId + 1\n    default:\n      return (d: SlotData) => d.formationSlotId + 1\n  }\n}\n\n/**\n * wraps label, replacing label with \"B\" for base slots\n * \"V\" for video slots\n * @param label label function\n */\nexport const planeLabel = (label: SlotDataFun) => (d: SlotData) => {\n  return d.formation.baseIds.includes(d.formationSlotId)\n    ? \"B\"\n    : d.plane.hasVideo && d.planeSlotId === d.plane.videoId\n    ? \"V\"\n    : label(d)\n}\nconst scaledCoord = (point: Polar, type: FormationType) =>\n  (type === FormationType.HD ? point.flip(PI / 2) : point).scale(SCALE_FACTOR)\n\nconst scaledPosition = ({\n  formationSlot: { position },\n  formation: { type }\n}: SlotData) => scaledCoord(position, type)\n\nconst scaledOffset = ({\n  formationSlot: { offset },\n  formation: { type }\n}: SlotData) => scaledCoord(offset, type)\n\nexport const arc = (d: SlotData) => {\n  const scaledPos = scaledPosition(d)\n  const dockAngle = d.formationSlot.dockAngle\n  return d3.arc()({\n    outerRadius: scaledPos.radius,\n    innerRadius: scaledPos.radius,\n    startAngle: scaledPos.d3theta - dockAngle,\n    endAngle: scaledPos.d3theta + dockAngle\n  })\n}\n\nexport const x = (d: SlotData) => scaledPosition(d).x\nexport const y = (d: SlotData) => scaledPosition(d).y\nexport const translate = (d: SlotData) =>\n  `translate(${scaledOffset(d).x},${scaledOffset(d).y})`\n\nexport const planeX = (d: SlotData) => planeDrawers[d.plane.type].x(d)\nexport const planeY = (d: SlotData) => planeDrawers[d.plane.type].y(d)\n\nexport const highlight = (d: SlotData) => {\n  d3.selectAll(`[formationSlotId=\"${d.formationSlotId}\"].slot circle`)\n    .transition()\n    .ease(d3.easeBack.overshoot(3))\n    .attr(\"r\", 20)\n}\nexport const unhighlight = (d: SlotData) => {\n  d3.selectAll(`[formationSlotId=\"${d.formationSlotId}\"].slot circle`)\n    .transition()\n    .ease(d3.easeBack.overshoot(3))\n    .attr(\"r\", 16)\n}\n\nexport const addSlotGroup = <E extends BaseType>(\n  selection: d3.Selection<E, SlotData, SVGGElement, any>,\n  x: SlotDataFun,\n  y: SlotDataFun,\n  fill: SlotDataFun,\n  label: SlotDataFun\n) => {\n  return selection\n    .append(\"g\")\n    .classed(\"slot\", true)\n    .on(\"mouseover\", highlight)\n    .on(\"mouseout\", unhighlight)\n    .attr(\"formationSlotId\", d => d.formationSlotId)\n    .call(slotG =>\n      slotG\n        .append(\"circle\")\n        .attr(\"cx\", x)\n        .attr(\"cy\", y)\n        .attr(\"r\", 16)\n        .attr(\"fill\", fill)\n    )\n    .call(slotG =>\n      slotG\n        .append(\"text\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dominant-baseline\", \"central\")\n        .attr(\"x\", x)\n        .attr(\"y\", y)\n        .text(label)\n    )\n}\n\nexport const addSlot = <E extends BaseType>(\n  g: d3.Selection<E, SlotData, SVGGElement, any>,\n  x?: SlotDataFun,\n  y?: SlotDataFun,\n  fill?: SlotDataFun,\n  label?: SlotDataFun\n) => {\n  return g\n    .append(\"g\")\n    .classed(\"slot\", true)\n    .on(\"mouseover\", highlight)\n    .on(\"mouseout\", unhighlight)\n    .attr(\"formationSlotId\", d => d.formationSlotId)\n    .call(slotG => {\n      slotG\n        .append(\"circle\")\n        .attr(\"r\", 16)\n        .call(circle => {\n          x && circle.attr(\"cx\", x)\n          y && circle.attr(\"cy\", y)\n          fill && circle.attr(\"fill\", fill)\n        })\n      slotG\n        .append(\"text\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dominant-baseline\", \"central\")\n        .call(text => {\n          x && text.attr(\"x\", x)\n          y && text.attr(\"y\", y)\n          label && text.text(label)\n        })\n    })\n}\n\nexport const updateSlot = (\n  g: d3.Transition<SVGGElement, SlotData, SVGGElement, {}>,\n  x: SlotDataFun,\n  y: SlotDataFun,\n  fill: SlotDataFun,\n  label: SlotDataFun\n) => {\n  g.select(\"g.slot circle\")\n    .attr(\"cx\", x)\n    .attr(\"cy\", y)\n    .attr(\"fill\", fill)\n\n  g.select(\"g.slot text\")\n    .attr(\"x\", x)\n    .attr(\"y\", y)\n    .text(label)\n}\n\nexport const transitionOut = (\n  exit: d3.Selection<SVGGElement, any, SVGGElement, any>,\n  t: d3.Transition<BaseType, any, any, any>\n) =>\n  exit\n    .transition(t)\n    .attr(\"transform\", \"scale(0)\")\n    .remove()\n","import {\n  Plane,\n  SlotData,\n  Formation,\n  FormationSlot\n} from \"../formation/interfaces\"\nimport AbstractDrawer from \"./AbstractDrawer\"\nimport * as d3 from \"d3\"\nimport { group as d3Group } from \"d3-array\"\nimport PlanePosition from \"../formation/PlanePosition\"\nimport { ViewConfigState, ShowOption, FormationType } from \"../store/types\"\nimport Polar from \"../geometry/Polar\"\nimport { PI, SCALE_FACTOR, TAU } from \"../constants\"\nimport {\n  planeX,\n  planeY,\n  addSlot,\n  updateSlot,\n  transitionOut,\n  SlotDataFun,\n  planeLabel\n} from \"./slotdatafuns\"\nimport { BaseType } from \"d3\"\nimport { planeDrawers, line, PLANE_SCALE_FACTOR } from \"./planedrawers\"\nimport { SlottedPlane } from \"./interfaces\"\nimport { Box } from \"../geometry/Box\"\n\nconst planeCoordinates = ({\n  planes,\n  viewConfig: { show },\n  formation: { radius, type }\n}: PlanesArgs) => {\n  switch (show) {\n    case ShowOption.FORMATION:\n    case ShowOption.PLANES: {\n      //if we're only showing planes, then draw them in a line\n      const positions = planes.map(p => p.position)\n      const positionToCoordinate = new Map(\n        [PlanePosition.LT, PlanePosition.LEAD, PlanePosition.RT]\n          .filter(p => positions.includes(p))\n          .map((p, idx, all) => {\n            const offset = idx * 300 - (all.length - 1) * 150\n            return [p, new Polar(Math.abs(offset), offset >= 0 ? 0 : PI)]\n          })\n      )\n      return positionToCoordinate\n    }\n    case ShowOption.BOTH: {\n      //if we're showing planes and formation, draw outside of formation radius\n      const positionToCoordinate = new Map(\n        planes.map(({ position, theta }) => {\n          const coord = new Polar(\n            Math.max(7, radius + 3) * SCALE_FACTOR,\n            position === PlanePosition.LEAD ? TAU / 12 : theta\n          )\n          return [\n            position,\n            type === FormationType.HD ? coord.flip(PI / 2) : coord\n          ]\n        })\n      )\n      return positionToCoordinate\n    }\n  }\n}\n\nconst labelPosition = ({ formation: { radius, type } }: PlanesArgs) => {\n  const coord = new Polar(Math.max(7, radius + 3) * SCALE_FACTOR, TAU / 12)\n  return type === FormationType.HD ? coord : coord.flip(PI / 2) // flip on opposite side of lead plane\n}\n\nconst drawLabel = (\n  group: d3.Selection<SVGGElement, {}, null, undefined>,\n  formation: Formation,\n  t: d3.Transition<d3.BaseType, any, any, any>,\n  labelCoord: Polar,\n  show: ShowOption\n) => {\n  group\n    .selectAll<SVGGElement, Formation>(\"g.label\")\n    .data(show === ShowOption.PLANES ? [] : [formation])\n    .join(\n      enter =>\n        enter\n          .append(\"g\")\n          .classed(\"label\", true)\n          .call(g => {\n            g.append(\"path\")\n              .attr(\"d\", line([{ x: 0, y: 0 }, { x: 0, y: -4 }])!)\n              .attr(\"stroke-width\", 3)\n              .attr(\"stroke\", \"black\")\n\n            g.append(\"path\")\n              .attr(\"d\", line([{ x: -1, y: -3 }, { x: 0, y: -4 }])!)\n              .attr(\"stroke-width\", 3)\n              .attr(\"stroke\", \"black\")\n\n            g.append(\"path\")\n              .attr(\"d\", line([{ x: 1, y: -3 }, { x: 0, y: -4 }])!)\n              .attr(\"stroke-width\", 3)\n              .attr(\"stroke\", \"black\")\n            g.append(\"text\")\n              .classed(\"type\", true)\n              .attr(\"text-anchor\", \"middle\")\n              .attr(\"dominant-baseline\", \"central\")\n              .attr(\"x\", 0)\n              .attr(\"y\", PLANE_SCALE_FACTOR)\n\n            g.append(\"text\")\n              .classed(\"slots\", true)\n              .attr(\"text-anchor\", \"middle\")\n              .attr(\"dominant-baseline\", \"central\")\n              .attr(\"x\", 0)\n              .attr(\"y\", 2 * PLANE_SCALE_FACTOR)\n          })\n          .attr(\"transform\", \"translate(0,0) scale(0)\"),\n      update => update,\n      exit =>\n        exit\n          .transition(t)\n          .attr(\"transform\", \"translate(0,0) scale(0)\")\n          .remove()\n    )\n    .call(g => {\n      g.select(\"text.type\").text(d => {\n        switch (d.type) {\n          case FormationType.HD:\n            return \"Head Down from below\"\n          case FormationType.HD_ABOVE:\n            return \"Head Down from above\"\n          case FormationType.HU:\n            return \"Head Up\"\n          default:\n            return \"Unknown formation type\"\n        }\n      })\n      g.select(\"text.slots\").text(d => `${d.slots.length} slots`)\n    })\n    .transition(t)\n    .attr(\"transform\", `translate(${labelCoord.x}, ${labelCoord.y})`)\n\n  const labelBox =\n    show === ShowOption.PLANES\n      ? new Box(0, 0, 0, 0)\n      : new Box(-3, -2, 3, 4).scale(PLANE_SCALE_FACTOR).translate(labelCoord)\n\n  return labelBox\n}\n\ninterface PlanesArgs {\n  slots: SlotData[]\n  planes: Plane[]\n  formation: Formation\n  viewConfig: ViewConfigState\n  fill: SlotDataFun\n  label: SlotDataFun\n}\nexport default class PlanesDrawer extends AbstractDrawer<PlanesArgs, Box> {\n  draw(args: PlanesArgs, t: d3.Transition<BaseType, any, any, any>) {\n    const p2c = planeCoordinates(args)\n    const labelCoord = labelPosition(args)\n\n    const { fill, label } = args\n\n    // const label = (d: SlotData) => d.plane.slots[d.planeSlotId].jr.toString()\n\n    const slotsByPlane: SlottedPlane[] =\n      args.viewConfig.show === ShowOption.FORMATION\n        ? []\n        : Array.from(d3Group(args.slots, d => d.plane))\n            .map(([plane, slotData]) => ({ plane, slotData }))\n            .map(({ plane, slotData }) => {\n              // add in psuedo slot for video if plane has it\n\n              const dummyFormationSlot: FormationSlot = {\n                reverseBuildOrder: 0,\n                buildOrder: 0,\n                offset: new Polar(0, 0),\n                position: new Polar(0, 0),\n                dockAngle: 0\n              }\n              const videoSlot = {\n                formationSlotId: -1,\n                formation: args.formation,\n                formationSlot: dummyFormationSlot,\n                planeId: slotData[0] ? slotData[0].planeId : -1,\n                plane: plane,\n                planeSlotId: plane.videoId,\n                byPlaneSlotId: -1\n              }\n\n              if (plane.hasVideo) {\n                return {\n                  plane,\n                  slotData: [...slotData, videoSlot]\n                }\n              } else {\n                return { plane, slotData }\n              }\n            })\n\n    this.group\n      .selectAll<SVGGElement, SlottedPlane>(\"g.plane\")\n      .data<SlottedPlane>(\n        slotsByPlane,\n        d => `${d.plane.position}.${d.plane.type}`\n      )\n      .join(\n        enter =>\n          enter\n            .append(\"g\")\n            .classed(\"plane\", true)\n            .each(({ plane }, i, nodes) => {\n              //draw each plane frame\n              planeDrawers[plane.type].draw(d3.select(nodes[i]), t)\n            })\n            .attr(\"transform\", \"translate(0,0) scale(0)\"),\n        undefined,\n        exit => transitionOut(exit, t)\n      )\n      .transition(t)\n      .attr(\n        \"transform\",\n        ({ plane: { position } }) =>\n          `translate(${p2c.get(position)!.x},${p2c.get(position)!.y}) scale(1)` //transition planes from center\n      )\n      .selection()\n      .selectAll<SVGGElement, SlotData>(\"g.slot\")\n      .data(\n        d => d.slotData,\n        d => `${d.formationSlotId}.${d.planeId}.${d.plane.type}`\n      )\n      .join(\n        addSlot, //add slots on enter without initial coordinates or label\n        undefined,\n        exit => transitionOut(exit, t)\n      )\n      .transition(t)\n      .attr(\"transform\", \"scale(1)\")\n      .call(slotG => {\n        updateSlot(slotG, planeX, planeY, fill, planeLabel(label))\n      })\n\n    const labelBox = drawLabel(\n      this.group,\n      args.formation,\n      t,\n      labelCoord,\n      args.viewConfig.show\n    )\n\n    return slotsByPlane.reduce((box, { plane }) => {\n      return box.union(\n        planeDrawers[plane.type].box.translate(p2c.get(plane.position)!)\n      )\n    }, labelBox)\n  }\n}\n","import { SlotData } from \"../formation/interfaces\"\nimport AbstractDrawer from \"./AbstractDrawer\"\nimport { ViewConfigState, ShowOption, FormationType } from \"../store/types\"\nimport {\n  x,\n  y,\n  translate,\n  updateSlot,\n  addSlot,\n  arc,\n  transitionOut,\n  SlotDataFun\n} from \"./slotdatafuns\"\nimport { Transition, BaseType } from \"d3\"\nimport { SCALE_FACTOR } from \"../constants\"\nimport { Box } from \"../geometry/Box\"\n\ninterface FormationArgs {\n  slots: SlotData[]\n  viewConfig: ViewConfigState\n  fill: SlotDataFun\n  label: SlotDataFun\n}\nexport default class FormationDrawer extends AbstractDrawer<\n  FormationArgs,\n  Box\n> {\n  draw(\n    { slots, viewConfig, fill, label }: FormationArgs,\n    t: Transition<BaseType, any, any, any>\n  ) {\n    const slotData: SlotData[] =\n      viewConfig.show === ShowOption.PLANES ? [] : slots\n\n    this.group\n      .selectAll<SVGGElement, SlotData>(\"g.slotgroup\")\n      .data<SlotData>(slotData, d => d.formationSlotId.toString())\n      .join(\n        enter =>\n          enter\n            .append(\"g\")\n            .attr(\"class\", \"slotgroup\") // slot plus grips\n            .attr(\"transform\", \"translate(0,0) scale(0)\") //start scaled down\n            .call(g => {\n              g.append(\"path\") //add the grips path\n                .attr(\"class\", \"grips\")\n                .attr(\"d\", arc)\n              addSlot(g, x, y, fill, label) //add the slot circle with fill\n            }),\n        undefined, //pass through, since we want to transition both new and old points\n        exit => transitionOut(exit, t)\n      )\n      .transition(t)\n      .attr(\"transform\", d => translate(d) + \" scale(1)\") //scale up translate\n      .call(g => {\n        //basically a no op for data that just entered\n        g.select(\"path\").attr(\"d\", arc)\n        updateSlot(g, x, y, fill, label)\n      })\n\n    if (viewConfig.show === ShowOption.PLANES) {\n      return new Box(-1, -1, 1, 1).scale(SCALE_FACTOR)\n    }\n\n    const box = slotData[0].formation.box.scale(SCALE_FACTOR)\n    return slotData[0].formation.type === FormationType.HD ? box.flipX() : box\n  }\n}\n","import React from \"react\"\nimport * as d3 from \"d3\"\nimport \"./FormationComponent.css\"\n\nimport { Formation, Plane, SlotData } from \"../formation/interfaces\"\nimport PlanesDrawer from \"../drawing/PlanesDrawer\"\nimport { ViewConfigState } from \"../store/types\"\nimport FormationDrawer from \"../drawing/FormationDrawer\"\nimport { SlotDataFun } from \"../drawing/slotdatafuns\"\nimport { BaseType } from \"d3\"\nimport { Box } from \"../geometry/Box\"\n\ntype Transition = d3.Transition<BaseType, any, any, any>\n\ninterface FormationProps {\n  formation: Formation\n  planes: Plane[]\n  slots: SlotData[]\n  viewConfig: ViewConfigState\n  fill: SlotDataFun\n  label: SlotDataFun\n}\nexport default class FormationComponent extends React.Component<\n  FormationProps,\n  {}\n> {\n  svg!: d3.Selection<SVGSVGElement, {}, null, undefined>\n  allGrp!: d3.Selection<SVGGElement, {}, null, undefined>\n  wrapper!: d3.Selection<SVGGElement, {}, null, undefined>\n  zoom!: d3.ZoomBehavior<SVGSVGElement, {}>\n  formationDrawer!: FormationDrawer\n  planesDrawer!: PlanesDrawer\n\n  height() {\n    return parseInt(this.svg.style(\"height\"), 10)\n  }\n\n  width() {\n    return parseInt(this.svg.style(\"width\"), 10)\n  }\n\n  componentDidMount() {\n    this.wrapper = this.svg.append(\"g\")\n    this.allGrp = this.wrapper.append(\"g\")\n\n    this.zoom = d3\n      .zoom<SVGSVGElement, {}>()\n      .scaleExtent([0.25, 2])\n      .on(\"zoom\", () => this.wrapper.attr(\"transform\", d3.event.transform))\n\n    this.svg\n      .call(this.zoom) //allows user zoom\n      .call(this.zoom.translateBy, this.width() / 2, this.height() / 2) //set initial zoom  to center\n\n    //bounding box\n    // https://bl.ocks.org/iamkevinv/0a24e9126cd2fa6b283c6f2d774b69a2\n\n    const t = d3.transition().duration(1000) as Transition\n\n    this.formationDrawer = new FormationDrawer().withGroup(\n      this.allGrp.append(\"g\")\n    )\n    this.planesDrawer = new PlanesDrawer().withGroup(this.allGrp.append(\"g\"))\n\n    const formationBox = this.formationDrawer.draw(this.props, t)\n    const planeBox = this.planesDrawer.draw(this.props, t)\n\n    // console.log({ box, planeBox })\n\n    // this.allGrp\n    //   .append(\"rect\")\n    //   .attr(\"x\", planeBox.x0)\n    //   .attr(\"y\", planeBox.y0)\n    //   .attr(\"width\", planeBox.width)\n    //   .attr(\"height\", planeBox.height)\n    //   .attr(\"fill\", \"none\")\n    //   .attr(\"stroke-widht\", 1)\n    //   .attr(\"stroke\", \"black\")\n\n    this.zoomToBox(formationBox.union(planeBox), t)\n  }\n\n  componentDidUpdate() {\n    const t = d3.transition().duration(1000) as Transition\n    const formationBox = this.formationDrawer.draw(this.props, t)\n    const planeBox = this.planesDrawer.draw(this.props, t)\n\n    this.zoomToBox(formationBox.union(planeBox), t)\n  }\n\n  zoomToBox(box: Box, t: Transition) {\n    this.allGrp\n      .transition(t)\n      .attr(\"transform\", `translate(${-box.cx}, ${-box.cy})`)\n    this.svg\n      .transition(t)\n      .call(\n        this.zoom.transform,\n        d3.zoomIdentity\n          .translate(this.width() / 2, this.height() / 2)\n          .scale(\n            Math.min(this.width() / box.width, this.height() / box.height) *\n              0.95\n          )\n      )\n  }\n\n  render() {\n    return (\n      <svg\n        width={\"100%\"}\n        height={\"100%\"}\n        ref={element => (this.svg = d3.select(element!).attr(\"id\", \"svg\"))}\n      />\n    )\n  }\n}\n","export default function approxeq(\n  a: number,\n  b: number,\n  eps = Math.sqrt(Number.EPSILON)\n) {\n  return Math.abs(a - b) < eps\n}\n","import lap from \"./lap\"\n\ntype ScoreFun<A, B> = (a: A, b: B) => number\n\n//takes a scoreFun that takes an A and a B\n//and converts it to a function that takes i, j for i, j in [0, number of as/bs)\n//for use with lap()\nfunction cost<A, B>(as: A[], bs: B[], scoreFun: ScoreFun<A, B>) {\n  //memoize scoreFun\n  const memo = new Map<string, number>()\n  return (i: number, j: number): number => {\n    if (i >= as.length) {\n      //it's free to assign nothing from as to any b\n      return 0\n    }\n    const key = `${i}.${j}`\n    if (!memo.has(key)) {\n      const a = as[i]\n      const b = bs[j]\n      memo.set(key, scoreFun(a, b))\n    }\n    return memo.get(key)!\n  }\n}\n\n/**\n * takes two arrays of things and a function that computes a score between a pair of those things\n * and assigns each thing in the first array to a thing in the second array,\n * minimizing the sum of the scores of the assigned pairs\n *\n * The second array can be longer than the first,\n * in which case some things in the second won't get assigned to the first\n * @param as\n * @param bs\n * @param scoreFun\n */\nfunction lapwrapper<A, B>(\n  as: A[],\n  bs: B[],\n  scoreFun: ScoreFun<A, B>\n): [A, B][] {\n  if (as.length > bs.length) {\n    throw new Error(\"as can't be longer than bs\")\n  }\n\n  const badScores = as.flatMap(a =>\n    bs.flatMap(b => {\n      const score = scoreFun(a, b)\n      return score < 0 || score === Infinity ? [{ a, b, score }] : []\n    })\n  )\n\n  if (badScores.length > 0) {\n    console.warn(\"Scores should be non-negative and not infinity: \", badScores)\n  }\n\n  const result = lap(bs.length, cost(as, bs, scoreFun))\n\n  if (\n    //check everything in a got assigned to something in b\n    !result.row.slice(0, as.length).every(r => r >= 0 && r < bs.length) ||\n    //check everything in a has a unique b\n    new Set(result.row.slice(0, as.length)).size != as.length ||\n    //check the computation didn't explode\n    result.cost === Infinity\n  ) {\n    const allScores = as.flatMap(a =>\n      bs.map(b => ({ a, b, score: scoreFun(a, b) }))\n    )\n    console.error(\"something's weird\", {\n      allScores,\n      result\n    })\n  }\n\n  return Array.from(result.row.slice(0, as.length)).map(\n    (p: number, i: number) => {\n      const a = as[i]\n      const b = bs[p]\n      return [a, b]\n    }\n  )\n}\n\n/**\n * returns a function that (returns a function that) tries functions in funs(a,b) in order until it finds\n * a result that isn't undefined, and returns that. if nothing is found, fallback is used, which must be a propper\n * ScoreFun\n * @param funs score functions to try\n * @param fallback fallback score function\n */\nexport const combineScoreFuns = <A, B>(\n  ...funs: ((a: A, b: B) => number | undefined)[]\n) => (fallback: ScoreFun<A, B>) => (a: A, b: B) => {\n  for (let i = 0; i < funs.length; i++) {\n    const fun = funs[i]\n    const val = fun(a, b)\n    if (val) {\n      return val\n    }\n  }\n  return fallback(a, b)\n}\n\nexport default lapwrapper\n","//https://github.com/Fil/lap-jv\n/************************************************************************\n*\n*  lap.js -- ported to javascript from\n\n   lap.cpp\n   version 1.0 - 4 September 1996\n   author: Roy Jonker @ MagicLogic Optimization Inc.\n   e-mail: roy_jonker@magiclogic.com\n\n   Code for Linear Assignment Problem, according to\n\n   \"A Shortest Augmenting Path Algorithm for Dense and Sparse Linear\n    Assignment Problems,\" Computing 38, 325-340, 1987\n\n   by\n\n   R. Jonker and A. Volgenant, University of Amsterdam.\n\n*\n   PORTED TO JAVASCRIPT 2017-01-02 by Philippe Riviere(fil@rezo.net)\n   CHANGED 2016-05-13 by Yang Yong(yangyongeducation@163.com) in column reduction part according to\n   matlab version of LAPJV algorithm(Copyright (c) 2010, Yi Cao All rights reserved)--\n   https://www.mathworks.com/matlabcentral/fileexchange/26836-lapjv-jonker-volgenant-algorithm-for-linear-assignment-problem-v3-0:\n*\n*************************************************************************/\n\n/* This function is the jv shortest augmenting path algorithm to solve the assignment problem */\nexport default function lap(dim, cost) {\n  // input:\n  // dim        - problem size\n  // cost       - cost callback (or matrix)\n\n  // output:\n  // rowsol     - column assigned to row in solution\n  // colsol     - row assigned to column in solution\n  // u          - dual variables, row reduction numbers\n  // v          - dual variables, column reduction numbers\n\n  // convert the cost matrix (old API) to a callback (new API)\n  if (typeof cost === \"object\") {\n    var cost_matrix = cost;\n    cost = function (i, j) {\n      return cost_matrix[i][j];\n    };\n  }\n\n  var sum = 0;\n  {\n    let i1, j1;\n    for (i1 = 0; i1 < dim; i1++) {\n      for (j1 = 0; j1 < dim; j1++)\n        sum += cost(i1, j1);\n    }\n  }\n  const BIG = 10000 * (sum / dim);\n  const epsilon = sum / dim / 10000;\n  const rowsol = new Int32Array(dim),\n    colsol = new Int32Array(dim),\n    u = new Float64Array(dim),\n    v = new Float64Array(dim);\n  let unassignedfound;\n  /* row */\n  let i, imin, numfree = 0, prvnumfree, f, i0, k, freerow; // *pred, *free\n  /* col */\n  let j, j1, j2, endofpath, last, low, up; // *collist, *matches\n  /* cost */\n  let min, h, umin, usubmin, v2; // *d\n\n  const free = new Int32Array(dim); // list of unassigned rows.\n  const collist = new Int32Array(dim); // list of columns to be scanned in various ways.\n  const matches = new Int32Array(dim); // counts how many times a row could be assigned.\n  const d = new Float64Array(dim); // 'cost-distance' in augmenting path calculation.\n  const pred = new Int32Array(dim); // row-predecessor of column in augmenting/alternating path.\n\n  // init how many times a row will be assigned in the column reduction.\n  for (i = 0; i < dim; i++)\n    matches[i] = 0;\n\n  // COLUMN REDUCTION\n  for (\n    j = dim;\n    j--; // reverse order gives better results.\n\n  ) {\n    // find minimum cost over rows.\n    min = cost(0, j);\n    imin = 0;\n    for (i = 1; i < dim; i++)\n      if (cost(i, j) < min) {\n        min = cost(i, j);\n        imin = i;\n      }\n    v[j] = min;\n    if (++matches[imin] === 1) {\n      // init assignment if minimum row assigned for first time.\n      rowsol[imin] = j;\n      colsol[j] = imin;\n    } else if (v[j] < v[rowsol[imin]]) {\n      j1 = rowsol[imin];\n      rowsol[imin] = j;\n      colsol[j] = imin;\n      colsol[j1] = -1;\n    } else colsol[j] = -1; // row already assigned, column not assigned.\n  }\n\n  // REDUCTION TRANSFER\n  for (i = 0; i < dim; i++) {\n    if (\n      matches[i] === 0 // fill list of unassigned 'free' rows.\n    )\n      free[numfree++] = i;\n    else if (matches[i] === 1) {\n      // transfer reduction from rows that are assigned once.\n      j1 = rowsol[i];\n      min = BIG;\n      for (j = 0; j < dim; j++)\n        if (j !== j1)\n          if (cost(i, j) - v[j] < min + epsilon) min = cost(i, j) - v[j];\n      v[j1] = v[j1] - min;\n    }\n  }\n\n  // AUGMENTING ROW REDUCTION\n  let loopcnt = 0; // do-loop to be done twice.\n  do {\n    loopcnt++;\n\n    // scan all free rows.\n    // in some cases, a free row may be replaced with another one to be scanned next.\n    k = 0;\n    prvnumfree = numfree;\n    numfree = 0; // start list of rows still free after augmenting row reduction.\n    while (k < prvnumfree) {\n      i = free[k];\n      k++;\n\n      // find minimum and second minimum reduced cost over columns.\n      umin = cost(i, 0) - v[0];\n      j1 = 0;\n      usubmin = BIG;\n      for (j = 1; j < dim; j++) {\n        h = cost(i, j) - v[j];\n        if (h < usubmin)\n          if (h >= umin) {\n            usubmin = h;\n            j2 = j;\n          } else {\n            usubmin = umin;\n            umin = h;\n            j2 = j1;\n            j1 = j;\n          }\n      }\n\n      i0 = colsol[j1];\n      if (umin < usubmin + epsilon)\n        //         change the reduction of the minimum column to increase the minimum\n        //         reduced cost in the row to the subminimum.\n        v[j1] = v[j1] - (usubmin + epsilon - umin);\n      else if (i0 > -1) {\n        // minimum and subminimum equal.\n        // minimum column j1 is assigned.\n        // swap columns j1 and j2, as j2 may be unassigned.\n        j1 = j2;\n        i0 = colsol[j2];\n      }\n\n      // (re-)assign i to j1, possibly de-assigning an i0.\n      rowsol[i] = j1;\n      colsol[j1] = i;\n\n      if (i0 > -1)\n        if (umin < usubmin)\n          // minimum column j1 assigned earlier.\n          // put in current k, and go back to that k.\n          // continue augmenting path i - j1 with i0.\n          free[--k] = i0;\n        else\n          // no further augmenting reduction possible.\n          // store i0 in list of free rows for next phase.\n          free[numfree++] = i0;\n    }\n  } while (loopcnt < 2); // repeat once.\n\n  // AUGMENT SOLUTION for each free row.\n  for (f = 0; f < numfree; f++) {\n    freerow = free[f]; // start row of augmenting path.\n\n    // Dijkstra shortest path algorithm.\n    // runs until unassigned column added to shortest path tree.\n    for (j = dim; j--;) {\n      d[j] = cost(freerow, j) - v[j];\n      pred[j] = freerow;\n      collist[j] = j; // init column list.\n    }\n\n    low = 0; // columns in 0..low-1 are ready, now none.\n    up = 0; // columns in low..up-1 are to be scanned for current minimum, now none.\n    // columns in up..dim-1 are to be considered later to find new minimum,\n    // at this stage the list simply contains all columns\n    unassignedfound = false;\n    do {\n      if (up === low) {\n        // no more columns to be scanned for current minimum.\n        last = low - 1;\n\n        // scan columns for up..dim-1 to find all indices for which new minimum occurs.\n        // store these indices between low..up-1 (increasing up).\n        min = d[collist[up++]];\n        for (k = up; k < dim; k++) {\n          j = collist[k];\n          h = d[j];\n          if (h <= min) {\n            if (h < min) {\n              // new minimum.\n              up = low; // restart list at index low.\n              min = h;\n            }\n            // new index with same minimum, put on undex up, and extend list.\n            collist[k] = collist[up];\n            collist[up++] = j;\n          }\n        }\n        // check if any of the minimum columns happens to be unassigned.\n        // if so, we have an augmenting path right away.\n        for (k = low; k < up; k++)\n          if (colsol[collist[k]] < 0) {\n            endofpath = collist[k];\n            unassignedfound = true;\n            break;\n          }\n      }\n\n      if (!unassignedfound) {\n        // update 'distances' between freerow and all unscanned columns, via next scanned column.\n        j1 = collist[low];\n        low++;\n        i = colsol[j1];\n        h = cost(i, j1) - v[j1] - min;\n\n        for (k = up; k < dim; k++) {\n          j = collist[k];\n          v2 = cost(i, j) - v[j] - h;\n          if (v2 < d[j]) {\n            pred[j] = i;\n            if (v2 === min)\n              if (colsol[j] < 0) {\n                // new column found at same minimum value\n                // if unassigned, shortest augmenting path is complete.\n                endofpath = j;\n                unassignedfound = true;\n                break;\n              } else {\n                // else add to list to be scanned right away.\n                collist[k] = collist[up];\n                collist[up++] = j;\n              }\n            d[j] = v2;\n          }\n        }\n      }\n    } while (!unassignedfound);\n\n    // update column prices.\n    for (k = last + 1; k--;) {\n      j1 = collist[k];\n      v[j1] = v[j1] + d[j1] - min;\n    }\n\n    // reset row and column assignments along the alternating path.\n    do {\n      i = pred[endofpath];\n      colsol[endofpath] = i;\n      j1 = endofpath;\n      endofpath = rowsol[i];\n      rowsol[i] = j1;\n    } while (i !== freerow);\n  }\n\n  // calculate optimal cost.\n  let lapcost = 0;\n  for (i = dim; i--;) {\n    j = rowsol[i];\n    u[i] = cost(i, j) - v[j];\n    lapcost = lapcost + cost(i, j);\n  }\n\n  return {\n    cost: lapcost,\n    row: rowsol,\n    col: colsol,\n    u: u,\n    v: v\n  };\n}\n","import {\n  PlaneAssignment,\n  Formation,\n  Plane,\n  PlaneSlotAssignment\n} from \"./interfaces\"\nimport lapwrapper, { combineScoreFuns } from \"./lapwrapper\"\nimport * as d3 from \"d3\"\nimport PlanePosition from \"./PlanePosition\"\n\nconst slotPlane = (\n  plane: Plane,\n  formation: Formation,\n  formationSlotIds: number[]\n) => {\n  /**\n   * if formationSlotId is a base slot, should return 0 for the right base slot and a big number everywher eelse\n   * if formationSlotId is not a base slot, should return a big number if planeSlotId is a base slot\n   * @param formationSlotId\n   * @param planeSlotId\n   */\n  const baseScore = (formationSlotId: number, planeSlotId: number) => {\n    if (plane.position === PlanePosition.LEAD) {\n      if (formation.baseIds.includes(formationSlotId)) {\n        //formationSlotId is a base slot\n\n        //get which base slot it is\n        const baseIdIndex = formation.baseIds.findIndex(\n          id => id === formationSlotId\n        )\n\n        //0 score for that slot in plane, otherwise big\n        return planeSlotId === plane.baseIds[baseIdIndex] ? 0 : 10000\n      } else {\n        //formationSlotId is not a base slot\n\n        const baseSize = formation.baseIds.length\n\n        if (plane.baseIds.slice(0, baseSize).includes(planeSlotId)) {\n          //this plane slot should be in the base but isn't, give big score\n          return 10000\n        }\n      }\n    }\n  }\n\n  const specialSlotScore = (formationSlotId: number, planeSlotId: number) => {\n    if (plane.hasVideo) {\n      if (planeSlotId === plane.videoId) {\n        return 100000\n      }\n    }\n  }\n\n  const score = (formationSlotId: number, planeSlotId: number) => {\n    const slot = formation.slots[formationSlotId]\n    const { reverseBuildOrder } = slot\n    const { jr } = plane.slots[planeSlotId]\n\n    const slotJr = slot.offset.plus(slot.position).y\n\n    return Math.abs(jr) * reverseBuildOrder * 100 - slotJr * jr + 1000\n  }\n\n  return lapwrapper(\n    formationSlotIds,\n    d3.range(plane.filledSlots + (plane.hasVideo ? 1 : 0)),\n    plane.position === PlanePosition.LEAD\n      ? combineScoreFuns(specialSlotScore, baseScore)(score)\n      : combineScoreFuns(specialSlotScore)(score)\n  ).map(([formationSlotId, planeSlotId]) => ({ formationSlotId, planeSlotId }))\n}\n\nexport default function slotify(\n  formation: Formation,\n  planes: Plane[],\n  planeAssignments: PlaneAssignment[]\n): PlaneSlotAssignment[] {\n  return planes.flatMap((plane, planeId) => {\n    const formationSlotIds = planeAssignments\n      .filter(plane => plane.planeId === planeId)\n      .map(({ formationSlotId }) => formationSlotId)\n\n    const planeSlotAssignments = slotPlane(plane, formation, formationSlotIds)\n    return planeSlotAssignments.map(({ formationSlotId, planeSlotId }) => ({\n      formationSlotId,\n      planeId,\n      planeSlotId\n    }))\n  })\n}\n","import { Formation, Plane, SlotData } from \"./interfaces\"\nimport planeify from \"./planeify\"\nimport slotify from \"./slotify\"\nimport { rollup as d3Rollup } from \"d3-array\"\n\nexport default (formation: Formation, planes: Plane[]): SlotData[] => {\n  const planeAssignments = planeify(formation, planes)\n  const planeSlotAssignments = slotify(formation, planes, planeAssignments)\n\n  const planeIdToSortedFormationSlotIds = d3Rollup(\n    planeAssignments,\n    pa =>\n      pa.map(({ formationSlotId }) => formationSlotId).sort((a, b) => a - b),\n    ({ planeId }) => planeId\n  )\n\n  const formationSlotIdToByPlaneSlotId = new Map(\n    planes.flatMap((_, planeId, planes) => {\n      const priorSlots = planes\n        .slice(0, planeId)\n        .reduce((acc, p) => acc + p.filledSlots, 0)\n      return (planeIdToSortedFormationSlotIds.get(planeId) || []).map(\n        (formationSlotId, i) => [formationSlotId, priorSlots + i]\n      )\n    })\n  )\n\n  return planeSlotAssignments.map(\n    ({ formationSlotId, planeId, planeSlotId }) => ({\n      formationSlotId,\n      formation,\n      formationSlot: formation.slots[formationSlotId],\n      planeId,\n      plane: planes[planeId],\n      planeSlotId,\n      byPlaneSlotId: formationSlotIdToByPlaneSlotId.get(formationSlotId)!\n    })\n  )\n}\n","import Polar from \"../../geometry/Polar\"\n\nimport { range } from \"d3\"\nimport { FormationSlot, ComponentSlot } from \"../interfaces\"\n\nexport default abstract class Component {\n  slots: number\n  slotNumOffset: number\n\n  constructor(slots: number, slotNumOffset: number) {\n    if (slots < 0) {\n      throw new Error(`slots should be non-negative, was ${slots}`)\n    }\n    this.slots = slots\n    this.slotNumOffset = slotNumOffset\n  }\n\n  checkSlot(slot: number) {\n    if (slot < 0 || slot >= this.slots)\n      throw new Error(`slot should be in [0, ${this.slots}), was ${slot}`)\n  }\n\n  slotData(slot: number): ComponentSlot {\n    this.checkSlot(slot)\n\n    return {\n      offset: this.position(),\n      position: this.slotPosition(slot),\n      dockAngle: this.dockAngle(),\n      buildOrder: this.buildOrder(slot) + this.waiting()\n    }\n  }\n\n  allSlots(): ComponentSlot[] {\n    return range(this.slots).map(slot => this.slotData(slot))\n  }\n\n  //returns position of slot *relative to position of component*\n  slotPosition(s: number, offset = false) {\n    this.checkSlot(s)\n    const pos = new Polar(\n      this.radius(),\n      this.rotation() - 2 * s * this.dockAngle()\n    )\n    return offset ? pos.plus(this.position()) : pos\n  }\n\n  //returns position of left hand of slot *relative to center of formation*\n  dockPosition(s: number) {\n    this.checkSlot(s)\n    return this.slotPosition(s)\n      .rotate(-this.dockAngle())\n      .plus(this.position())\n  }\n\n  //how long this component is waiting before building\n  waiting(): number {\n    return Math.max(\n      ...this.parents().map(\n        parent => parent.waiting() + parent.maxBuildOrder()\n      ),\n      0\n    )\n  }\n\n  // return build order for last slot to build\n  abstract maxBuildOrder(): number\n\n  //should return build order for slot\n  abstract buildOrder(slot: number): number\n\n  //returns radius of this component\n  abstract radius(): number\n\n  //returns center of this component\n  abstract position(): Polar\n\n  //returns rotation in theta of where to place first slot\n  abstract rotation(): number\n\n  //returns angle between slot position and dock position, i.e. half of wingspan angle\n  abstract dockAngle(): number\n\n  //components this component is docked\n  abstract parents(): Component[]\n}\n","import { PI, TAU } from \"../../constants\"\nimport Component from \"./Component\"\nimport Polar from \"../../geometry/Polar\"\n\ninterface Dock {\n  c: Component\n  s: number\n}\n\nexport type PRRD = {\n  position: Polar;\n  radius: number;\n  rotation: number;\n  dockAngle: number;\n}\n\nexport default class Round extends Component {\n  left: Dock\n  right: Dock\n  firstRun: boolean\n  private _prrd: PRRD | undefined\n  /*\n  left and right are left hand and right hand docks. \n  Should be an with properties\n    - c: component\n    - s: slot index\n  */\n  constructor(slots: number, slotNumOffset: number, left: Dock, right: Dock) {\n    super(slots, slotNumOffset)\n    this.left = left\n    this.right = right\n    this.firstRun = true\n  }\n\n  parents() {\n    return Array.from(new Set([this.left.c, this.right.c]))\n  }\n\n  get prrd() {\n    if (!this._prrd) {\n      this._prrd = Round._positionRadiusRotationDockAngle(\n        this.left.c.dockPosition(this.left.s),\n        this.right.c.dockPosition(this.right.s),\n        this.slots\n      )\n    }\n    return this._prrd\n  }\n\n  //computes the centroid position\n  //component radius, and component rotation\n  //position, radius, rotation, dockangle\n  /*\n  leftDockPosition - where component's left hand dock is\n  rightDockPosition - where component's right hand dock is\n  slots - number of slots in this component\n  // parentCentroid - centroid of parent component, or center of formation. Used to pick the orien\n  */\n  static _positionRadiusRotationDockAngle(\n    leftDockPosition: Polar,\n    rightDockPosition: Polar,\n    slots: number\n  ): PRRD {\n    const dockDistance = leftDockPosition.distanceFrom(rightDockPosition)\n    const { radius, theta } = Round.__computeRadiusTheta(slots, dockDistance)\n\n    const angleDelta = leftDockPosition.angleTo(rightDockPosition)\n    const position = leftDockPosition.plus(\n      new Polar(radius, angleDelta - (PI - theta) / 2)\n    )\n\n    //the rotation is where the first slot (docking w/ right hand) goes\n    // TAU - theta is the whole arc angle, and their position is 1/(2*slots) around\n    const dockAngle = (TAU - theta) / (2 * slots)\n    const rotation = position.angleTo(rightDockPosition) - dockAngle\n\n    return { position, radius, rotation, dockAngle }\n  }\n\n  position() {\n    return this.prrd.position\n  }\n\n  radius() {\n    return this.prrd.radius\n  }\n\n  rotation() {\n    return this.prrd.rotation\n  }\n\n  dockAngle() {\n    return this.prrd.dockAngle\n  }\n\n  maxBuildOrder() {\n    return Math.ceil(this.slots / 2)\n  }\n\n  buildOrder(slot: number) {\n    this.checkSlot(slot)\n\n    //build from the ends\n    return Math.min(slot + 1, this.slots - slot)\n  }\n\n  // computes radius and angle of cutoff for a circle with the side cut off\n  // with length of the remaining curve part = s\n  // and length of flat bit = d\n  // I think it's O(-log(eps))\n  static __computeRadiusTheta(\n    s: number,\n    d: number,\n    eps = Math.sqrt(Number.EPSILON)\n  ) {\n    if (d < 0 || d > s) {\n      console.error(`d: ${d}, s: ${s}`)\n      throw new Error(\"d must be in [0, s]\")\n    }\n    var iters = 0\n    //try picking theta between lower and upper\n    function iter(lower = 0, upper = PI): number {\n      if (iters >= 100) {\n        throw new Error(\"didn't converge\")\n      }\n      iters = iters + 1\n      const mid = (upper + lower) / 2\n      // if ((upper - lower) < eps) {\n      //   return mid\n      // }\n\n      //candidate theta = mid\n      //compute radius from theta\n      const r = d / (2 * Math.sin(mid / 2))\n      //compute s from radius, theta\n      const ss = r * (TAU - mid)\n\n      if (Math.abs(ss - s) < eps) {\n        return mid\n      }\n\n      //if computed s is too big, try a bigger theta, else try smaller\n      return ss > s ? iter(mid, upper) : iter(lower, mid)\n    }\n    //iter returns theta, compute radius\n    const theta = iter()\n    return {\n      radius: s / (TAU - iter()),\n      theta: theta\n    }\n  }\n}\n","import Component from \"./Component\"\nimport Round, { PRRD } from \"./Round\"\nimport Polar from \"../../geometry/Polar\"\n\ninterface Dock {\n  c: Component\n  s: number\n}\n\nexport default class Whacker extends Component {\n  dock: Dock\n  hand: string\n  private _prrd: PRRD | undefined\n\n  /*\n  slots - \n  dock - { component, slot } this whacker is docked on\n  hand - docked with 'left' or 'right'\n \n  modeled as part of a pod (Round docked on one person) with slots * 2 + 1 slots\n  */\n  constructor(slots: number, slotNumOffset: number, dock: Dock, hand: string) {\n    super(slots, slotNumOffset)\n    this.dock = dock\n\n    if (hand !== \"left\" && hand !== \"right\")\n      throw new Error(\"Hand should be 'left' or 'right'\")\n    this.hand = hand\n  }\n\n  parents() {\n    return [this.dock.c]\n  }\n\n  //left hand dock position of the imaginary pod\n  _left() {\n    const { c, s } = this.dock\n    return this.hand === \"left\"\n      ? c.dockPosition(s)\n      : c\n          .slotPosition(s)\n          .rotate(-3 * c.dockAngle()) //move 1.5 slots to the left\n          .plus(c.position())\n  }\n\n  //right hand dock position of the imaginary pod\n  _right() {\n    const { c, s } = this.dock\n    return this.hand === \"left\"\n      ? c\n          .slotPosition(s)\n          .rotate(c.dockAngle()) //move half a slot to the right\n          .plus(c.position())\n      : c.dockPosition(s)\n  }\n\n  get prrd() {\n    if (!this._prrd) {\n      const psuedoSlots = this.slots * 2 + 1\n\n      this._prrd = Round._positionRadiusRotationDockAngle(\n        this._left(),\n        this._right(),\n        psuedoSlots\n      )\n\n      if (this.hand === \"left\") {\n        const invisibleSlots = psuedoSlots - this.slots\n        const { rotation, dockAngle } = this._prrd\n        const fixedRotation = Polar.unspin(\n          rotation - invisibleSlots * 2 * dockAngle\n        ) //rotate two slots to the right\n        this._prrd.rotation = fixedRotation\n      }\n    }\n    return this._prrd\n  }\n\n  maxBuildOrder() {\n    return this.slots\n  }\n\n  buildOrder(slot: number) {\n    this.checkSlot(slot)\n    return this.hand === \"left\" ? this.slots - slot : slot + 1\n  }\n\n  position() {\n    return this.prrd.position\n  }\n\n  radius() {\n    return this.prrd.radius\n  }\n\n  rotation() {\n    return this.prrd.rotation\n  }\n\n  dockAngle() {\n    return this.prrd.dockAngle\n  }\n}\n","import Polar from \"../../geometry/Polar\"\nimport Component from \"./Component\"\nimport { PI, TAU } from \"../../constants\"\n\nexport default class Base extends Component {\n  _rotation: number\n  constructor(slots: number, rotation = (3 * PI) / 2) {\n    super(slots, 0)\n    this._rotation = rotation\n  }\n\n  //angle to the first slot\n  rotation() {\n    return this._rotation\n  }\n\n  position() {\n    return new Polar(0, 0)\n  }\n\n  // circumference = 2 PI r\n  // circumference = # slots\n  radius() {\n    return this.slots / TAU\n  }\n\n  //angle between slot position and dock position\n  dockAngle() {\n    return TAU / (this.slots * 2)\n  }\n\n  maxBuildOrder(): number {\n    return 1\n  }\n\n  buildOrder(slot: number) {\n    this.checkSlot(slot)\n    return 1\n  }\n\n  parents() {\n    return []\n  }\n}\n","import { BaseSlot, SlotCollection, NumDict } from \"./interfaces\"\nimport arrayToDict from \"../util/arrayToDict\"\n\nexport default abstract class AbstractSlotCollection<S extends BaseSlot>\n  implements SlotCollection<S> {\n  private _slots?: S[]\n\n  protected abstract computeSlots(): S[]\n\n  get slots(): S[] {\n    if (!this._slots) {\n      this._slots = this.computeSlots()\n    }\n\n    return this._slots\n  }\n}\n","import Round from \"./components/Round\"\nimport Whacker from \"./components/Whacker\"\nimport Base from \"./components/Base\"\nimport Component from \"./components/Component\"\nimport AbstractSlotCollection from \"./AbstractSlotCollection\"\nimport { FormationSlot, Formation } from \"./interfaces\"\nimport * as d3 from \"d3\"\nimport { FormationType } from \"../store/types\"\nimport { PI } from \"../constants\"\nimport { Box } from \"../geometry/Box\"\n\ntype Ring = Component[]\ntype Dock = { c: Component; s: number }\n\n/**\n * computes the number of slots in a ring\n * @param {Number} ring index of ring,\n *         ring 0 = base,\n *         ring 1 = 1st pods\n *         ring 2 = 2nd pods\n *         ring 3 = if baseSize > 4, bridges, otherwise just pods on out\n *         ring 4 = if baseSize > 4, then pods on bridges in ring 3, otherwise just pods on podLines\n *         ring 5... pod lines on out\n */\nconst slotsInRing = (baseSize: number, ring: number): number => {\n  const podLines = Math.round(baseSize / 2)\n  const bridges = podLines > 2\n  if (ring === 0) {\n    return baseSize\n  }\n  if (ring === 1) {\n    return baseSize + podLines * 5\n  }\n  if (ring === 2) {\n    return baseSize + podLines * 10\n  }\n  if (ring === 3) {\n    return (\n      slotsInRing(baseSize, ring - 1) + (bridges ? 3 * podLines : 5 * podLines)\n    )\n  }\n  if (ring === 4) {\n    return (\n      slotsInRing(baseSize, ring - 1) + (bridges ? 5 * podLines : 5 * baseSize)\n    )\n  }\n  return (\n    slotsInRing(baseSize, 4) +\n    (ring - 4) * (bridges ? 5 * podLines : 5 * baseSize)\n  )\n}\n\n/**\n * gets dock positions for next ring given currently filled rings\n * @param rings an array of rings, 0th starting at base and going out\n */\nconst nextDockPositions = (\n  baseSize: number,\n  rings: Ring[]\n): { left: Dock; right: Dock }[] => {\n  if (rings.length > 10) {\n    throw new Error(\"somethings fucky\")\n  }\n  const bridges = baseSize !== 4\n\n  if (rings.length === 1) {\n    const base = rings[0][0]\n\n    return d3.range(0, baseSize, 2).map(slot => ({\n      left: { c: base, s: slot },\n      right: { c: base, s: (slot + baseSize - 1) % baseSize }\n    }))\n  }\n  if (\n    !bridges ||\n    rings.length === 2 ||\n    rings.length === 4 ||\n    rings.length >= 6\n  ) {\n    // if we're not using bridges\n    // or last ring (1) is 1st pods (and we need 2nd pods)\n    // or last ring (3) is bridges (and we need 2nd pods on those bridges)\n    // or we're way out (last ring >= 5)\n    // then we want pods on everything in the last ring\n    return rings[rings.length - 1].map(component => {\n      const isPod = component.slots === 5\n      return {\n        left: { c: component, s: 1 + (isPod ? 1 : 0) },\n        right: { c: component, s: 0 + (isPod ? 1 : 0) }\n      }\n    })\n  }\n  if (bridges && rings.length === 3) {\n    // ring 3 is bridges if there are bridges\n    const firstPods = rings[1]\n    const numBridges = firstPods.length\n    return d3.range(numBridges).map(bridgeNum => ({\n      left: { c: firstPods[(bridgeNum + 1) % numBridges], s: 0 },\n      right: { c: firstPods[bridgeNum], s: 3 }\n    }))\n  }\n  if (bridges && rings.length === 5) {\n    // if bridges, ring 5 is 2nd pods on bridges\n    const secondPods = rings[2]\n    const bridgeSecondPods = rings[4]\n    return secondPods\n      .flatMap((secondPod, idx) => [secondPod, bridgeSecondPods[idx]])\n      .map(component => {\n        return {\n          left: { c: component, s: component.slots === 5 ? 2 : 1 }, //5 -> pod, !5 (3) -> bridge\n          right: { c: component, s: component.slots === 5 ? 1 : 0 }\n        }\n      })\n  }\n  throw new Error(\"mmm\")\n}\n\n/**\n * this takes an array of rings starting with at least the Base, and\n * adds rings until all slots are included\n * @param {*} rings array of rings. (a ring is an array of components)\n */\nconst addRings = (slots: number, baseSize: number, rings: Ring[]): Ring[] => {\n  const completeRings = rings.length - 1\n\n  //compute slots in next ring\n  const nextRingSlots =\n    Math.min(slots, slotsInRing(baseSize, completeRings + 1)) -\n    slotsInRing(baseSize, completeRings)\n\n  if (nextRingSlots <= 0) return rings //we're done\n\n  const dockPositions = nextDockPositions(baseSize, rings)\n\n  // here a 'group' is either a pod, or, if there are less than 5 slots, two whackers\n  const slotGroups = dockPositions.length\n\n  const slotsPerGroup = Math.floor(nextRingSlots / slotGroups)\n  const groupsWithExtraSlot = nextRingSlots % slotGroups\n\n  const nextRing: Ring = dockPositions.flatMap(\n    ({ left, right }, groupNum): Ring => {\n      //slots in this group\n      const slotsToFill =\n        slotsPerGroup + (groupNum < groupsWithExtraSlot ? 1 : 0)\n      const isPod = left.c === right.c //left and right docking on same component is a pod, else bridge\n      const totalSlotsInGroup = isPod ? 5 : 3\n\n      const priorSlots =\n        slotsInRing(baseSize, completeRings) + //number of slots in prior rings\n        slotsPerGroup * groupNum + //number of slots in prior groups in this ring\n        Math.min(groupsWithExtraSlot, groupNum) //an extra slot per prior group, up to groupsWithExtraSlot\n\n      if (slotsToFill === totalSlotsInGroup) {\n        //if we have to fill the whole group, it's a pod\n        return [new Round(totalSlotsInGroup, priorSlots, left, right)]\n      } else {\n        //whackers\n        const leftHandSlots = Math.floor(slotsToFill / 2)\n        const rightHandSlots = leftHandSlots + (slotsToFill % 2) //if odd number, right hand whacker gets the extra\n        const whackers = []\n        if (rightHandSlots > 0) {\n          whackers.push(\n            new Whacker(rightHandSlots, priorSlots, right, \"right\")\n          )\n        }\n        if (leftHandSlots > 0) {\n          whackers.push(\n            new Whacker(\n              leftHandSlots,\n              priorSlots + rightHandSlots,\n              left,\n              \"left\"\n            )\n          )\n        }\n\n        return whackers\n      }\n    }\n  )\n  //recurse, add more rings to this prior plus this ring\n  return addRings(slots, baseSize, [...rings, nextRing])\n}\n\nclass FormationImpl extends AbstractSlotCollection<FormationSlot>\n  implements Formation {\n  components: Component[]\n  type: FormationType\n  constructor(components: Component[], type: FormationType) {\n    super()\n    this.components = components\n    this.type = type\n  }\n\n  protected computeSlots(): FormationSlot[] {\n    const reverseBuildOrder = this.reverseBuildOrder()\n    return this.components\n      .flatMap(c => c.allSlots())\n      .map((s, idx) => {\n        const adjustedSlot =\n          this.type === FormationType.HU\n            ? s\n            : {\n                ...s,\n                position: s.position.flip(PI / 2),\n                offset: s.offset.flip(PI / 2)\n              }\n        return { ...adjustedSlot, reverseBuildOrder: reverseBuildOrder[idx] }\n      })\n  }\n\n  get baseIds(): number[] {\n    return this.components\n      .find(c => c instanceof Base)!\n      .allSlots()\n      .map((_, idx) => idx)\n  }\n\n  get radius(): number {\n    const slotRadi = this.slots.map(\n      ({ position, offset }) => position.plus(offset).radius\n    )\n    return Math.max(...slotRadi)\n  }\n\n  get box(): Box {\n    return this.slots.reduce(\n      (b, { position, offset }) => b.expand(position.plus(offset)),\n      new Box(0, 0, 0, 0)\n    )\n  }\n\n  reverseBuildOrder() {\n    const parentToChildren = new Map(\n      this.components.map(component => [component, [] as Component[]])\n    )\n\n    this.components\n      .flatMap(child => child.parents().map(parent => ({ parent, child }))) //get all parent child pairs (many to many)\n      .forEach(({ parent, child }) =>\n        parentToChildren.get(parent)!.push(child)\n      )\n\n    const componentToWaiting = new Map<Component, number>()\n\n    const waiting = (component: Component): number => {\n      if (!componentToWaiting.has(component)) {\n        const children = parentToChildren.get(component)!\n        const numWaiting = Math.max(\n          ...children.map(child => waiting(child)! + child.maxBuildOrder()),\n          0\n        )\n\n        componentToWaiting.set(component, numWaiting)\n      }\n      return componentToWaiting.get(component)!\n    }\n    // waiting(this.components[0])\n    return this.components.flatMap(c => {\n      return d3\n        .range(c.slots)\n        .map(s => waiting(c) + c.maxBuildOrder() - c.buildOrder(s))\n    })\n  }\n}\n\n/**\n * Builds a formation using the following rules until we run out of slots\n *    1) Start with the base\n *    2) Add first pods on every other base slot, starting with the slot going up jump run moving left\n *    3) Add second pods on first pods\n *    4) If base size > 4, build bridges between frist pods\n *    5) If there are bridges, build 2nd pods on bridges\n *    6) Build pods on each pod line on out to infinity!\n *\n * If there are not enough slots to complete a ring of pods/bridges, then build whackers\n *\n * @param {Number} slots slots in this formation\n * @param {Number} baseSize\n * @returns an array of Components\n */\nexport default function buildFormation(\n  slots: number,\n  baseSize: number,\n  type: FormationType\n): Formation {\n  return new FormationImpl(\n    addRings(slots, baseSize, [[new Base(baseSize)]]).flat(),\n    type\n  )\n}\n","import { createSelector } from \"reselect\"\nimport {\n  PlaneType,\n  Slotting,\n  FormationConfigState,\n  PlaneState\n} from \"../store/types\"\nimport { AppState } from \"../store/reducer\"\n\nexport const getFormationConfig = (state: AppState): FormationConfigState =>\n  state.formationConfig\nexport const getPlanesConfig = (state: AppState): PlaneState[] =>\n  state.planesConfig\n\nexport type SlotOptions = {\n  slots: number;\n  min: number;\n  max: number;\n}\n\nconst slotOptions = (\n  formationConfig: { baseSize: number; slots: number },\n  planesConfig: PlaneState[]\n): SlotOptions => {\n  const { min, max } = planesConfig\n    .filter(({ type }) => type !== PlaneType.NONE)\n    .map(({ slotting, slots, hasVideo }) => ({\n      //compute min/max slots on each plane\n      planeMin: slotting === Slotting.FILL ? slots : 0,\n      planeMax: slots - (hasVideo ? 1 : 0)\n    }))\n    .reduce(\n      ({ min, max }, { planeMin, planeMax }) => ({\n        //add min/max slots for all planes\n        min: min + planeMin,\n        max: max + planeMax\n      }),\n      { min: 0, max: 0 }\n    )\n\n  const fixedMin = Math.max(min, formationConfig.baseSize)\n\n  return {\n    min: fixedMin,\n    max,\n    slots: Math.max(Math.min(formationConfig.slots, max), fixedMin)\n  }\n}\n\n/**\n * computes min, max, and current number of slots based on plane and formation config\n *\n * if current slots is outside of [min, max], it is set to min or max\n */\nexport default createSelector(\n  [getFormationConfig, getPlanesConfig],\n  slotOptions\n)\n","import AbstractSlotCollection from \"./AbstractSlotCollection\"\nimport { PlaneSlot, Plane } from \"./interfaces\"\nimport PlanePosition from \"./PlanePosition\"\nimport { TAU } from \"../constants\"\nimport * as d3 from \"d3\"\nimport { PlaneType } from \"../store/types\"\n\nexport class PlaneImpl extends AbstractSlotCollection<PlaneSlot>\n  implements Plane {\n  position: PlanePosition\n  filledSlots: number\n  type: PlaneType\n  hasVideo: boolean\n  hasSuperFloat: boolean\n\n  constructor(\n    position: PlanePosition,\n    filledSlots: number,\n    type: PlaneType,\n    hasVideo: boolean,\n    hasSuperFloat: boolean\n  ) {\n    super()\n    this.position = position\n    this.filledSlots = filledSlots\n    this.type = type\n    this.hasVideo = hasVideo\n    this.hasSuperFloat = hasSuperFloat\n  }\n\n  protected computeSlots(): PlaneSlot[] {\n    return d3\n      .range(24)\n      .map(x => ({ jr: x - 14 }))\n      .reverse()\n  }\n\n  get theta() {\n    switch (this.position) {\n      case PlanePosition.LEAD:\n        return (3 * TAU) / 12\n      case PlanePosition.LT:\n        return (7 * TAU) / 12\n      case PlanePosition.RT:\n        return (11 * TAU) / 12\n    }\n  }\n\n  get baseIds() {\n    switch (this.type) {\n      case PlaneType.OTTER:\n        return [7, 8, 9, 10, 11, 4, 3, 2, 5, 12]\n      case PlaneType.SKYVAN:\n        return [3, 4, 5, 8, 7, 6, 0, 1, 9, 10]\n      default:\n        return d3.range(10)\n    }\n  }\n\n  get videoId() {\n    switch (this.type) {\n      case PlaneType.OTTER:\n        return 0\n      case PlaneType.SKYVAN:\n        return 2\n      default:\n        return 10\n    }\n  }\n\n  get superFloatId() {\n    switch (this.type) {\n      case PlaneType.OTTER:\n        return 1\n      case PlaneType.SKYVAN:\n        return 0\n      default:\n        return 11\n    }\n  }\n}\n","import { PlaneState, PlaneType, Slotting } from \"../store/types\"\nimport { Plane } from \"./interfaces\"\nimport PlanePosition from \"./PlanePosition\"\nimport { PlaneImpl } from \"./planes\"\n\ntype FilledPlane = {\n  position: PlanePosition;\n  filledSlots: number;\n}\n\nconst countFilledSlots = (filledPlanes: FilledPlane[]) =>\n  filledPlanes.reduce((s, { filledSlots }) => s + filledSlots, 0)\n\n/**\n *\n * @param unfilledPlanes array of objects representing planes with slots left.\n *                       should have properties plane (lead, lt, rt), slots (total slots in plane)\n * @param slotsRemaining slots to put in unfilledPlanes\n * @param baseSize if unfilledPlanes includes lead plane, at least `baseSize` should go in it\n * @param filledPlanes array of planes already full, or partially full if slotsRemaining = 0\n */\nconst slotUnfilledPlanes = (\n  unfilledPlanes: PlaneState[],\n  slotsRemaining: number,\n  baseSize: number,\n  filledPlanes: FilledPlane[]\n): FilledPlane[] => {\n  if (unfilledPlanes.length === 0) {\n    return filledPlanes\n  }\n\n  const slotsPerPlane = slotsRemaining / unfilledPlanes.length\n\n  // if spreading remaing slots evently doesn't put enough in the lead plane for the base, fill that now\n  const lead = unfilledPlanes.find(\n    ({ position }) => position === PlanePosition.LEAD\n  )\n  if (lead && baseSize > slotsPerPlane) {\n    return slotUnfilledPlanes(\n      unfilledPlanes.filter(({ position }) => position !== PlanePosition.LEAD),\n      slotsRemaining - baseSize,\n      baseSize,\n      [{ position: PlanePosition.LEAD, filledSlots: baseSize }, ...filledPlanes]\n    )\n  }\n\n  //get planes with fewer total slots than slotsPerPlane and fill em up\n  const littlePlanes = unfilledPlanes\n    .filter(({ slots }) => slots < slotsPerPlane)\n    .map(({ position, slots }) => ({ position, filledSlots: slots }))\n\n  if (littlePlanes.length) {\n    const littlePlaneLabels = littlePlanes.map(({ position }) => position)\n    return slotUnfilledPlanes(\n      unfilledPlanes.filter(\n        ({ position }) => !littlePlaneLabels.includes(position)\n      ),\n      slotsRemaining - countFilledSlots(littlePlanes),\n      baseSize,\n      [...filledPlanes, ...littlePlanes]\n    )\n  }\n\n  // if we've gotten this far, there is room for at least slotsPerPlane on each unfilledPlane\n  const minSlotsPerPlane = Math.floor(slotsPerPlane)\n  const extras = slotsRemaining % minSlotsPerPlane\n\n  // if the lead plane is still in the mix, then always put one less on that plane\n  if (extras > 0 && lead) {\n    const filledLead = {\n      position: PlanePosition.LEAD,\n      filledSlots: minSlotsPerPlane\n    }\n    return slotUnfilledPlanes(\n      unfilledPlanes.filter(({ position }) => position !== PlanePosition.LEAD),\n      slotsRemaining - minSlotsPerPlane,\n      baseSize,\n      [filledLead, ...filledPlanes]\n    )\n  }\n\n  //okay now fill the rest. the first `extras` planes will get an extra\n  const remainingFilled = unfilledPlanes.map(({ position }, i) => ({\n    position,\n    filledSlots: minSlotsPerPlane + (extras > i ? 1 : 0)\n  }))\n\n  //phew\n  return [...filledPlanes, ...remainingFilled]\n}\n\n/**\n *\n * @param baseSize\n * @param planesConfig\n * @param slotOptions\n */\nconst filledPlanes = (\n  slots: number,\n  baseSize: number,\n  planesConfig: PlaneState[]\n): FilledPlane[] => {\n  const filledPlanes = planesConfig\n    .filter(\n      ({ type, slotting }) =>\n        type !== PlaneType.NONE && slotting === Slotting.FILL\n    )\n    .map(({ position, slots }) => ({ position, filledSlots: slots }))\n\n  const unfilledPlanes = planesConfig.filter(\n    ({ type, slotting }) =>\n      type !== PlaneType.NONE && slotting !== Slotting.FILL\n  )\n\n  return slotUnfilledPlanes(\n    unfilledPlanes,\n    slots - countFilledSlots(filledPlanes),\n    baseSize,\n    filledPlanes\n  )\n}\n\nexport default (\n  slots: number,\n  baseSize: number,\n  planesConfig: PlaneState[]\n): Plane[] => {\n  const slotsMap = new Map(\n    filledPlanes(slots, baseSize, planesConfig).map(\n      ({ position, filledSlots }) => [position, filledSlots]\n    )\n  )\n\n  return planesConfig.map(\n    ({ position, type, hasVideo, hasSuperFloat }) =>\n      new PlaneImpl(\n        position,\n        slotsMap.get(position)!,\n        type,\n        hasVideo,\n        hasSuperFloat\n      )\n  )\n}\n","import { createSelector } from \"reselect\"\nimport buildSlots from \"../formation/buildSlots\"\nimport buildFormation from \"../formation/buildFormation\"\nimport getSlotOptions from \"./getSlotOptions\"\nimport buildPlanes from \"../formation/buildPlanes\"\nimport { AppState } from \"../store/reducer\"\nimport { PlaneType, FormationType } from \"../store/types\"\n\nexport { default as getSlotOptions } from \"./getSlotOptions\"\n\nconst getSlots = (state: AppState) => getSlotOptions(state).slots\nconst getBaseSize = (state: AppState): number => state.formationConfig.baseSize\nconst getFormationType = (state: AppState): FormationType =>\n  state.formationConfig.type\nconst getFilteredPlanesConfig = (state: AppState) => {\n  return state.planesConfig.filter(({ type }) => type !== PlaneType.NONE)\n}\n\nexport const getFormation = createSelector(\n  [getSlots, getBaseSize, getFormationType],\n  buildFormation\n)\nexport const getPlanes = createSelector(\n  [getSlots, getBaseSize, getFilteredPlanesConfig],\n  buildPlanes\n)\nexport const getAllSlots = createSelector(\n  [getFormation, getPlanes],\n  buildSlots\n)\n","import { Formation, Plane, PlaneAssignment } from \"./interfaces\"\nimport PlanePosition from \"./PlanePosition\"\nimport Polar from \"../geometry/Polar\"\nimport { PI } from \"../constants\"\nimport approxeq from \"../util/approxeq\"\nimport lapwrapper, { combineScoreFuns } from \"./lapwrapper\"\nimport { range } from \"d3\"\n\n/**\n * Puts people in planes\n * @param formation\n * @param planes lead assumed to be first\n */\nexport default function planeify(\n  formation: Formation,\n  planes: Plane[]\n): PlaneAssignment[] {\n  if (planes[0].position !== PlanePosition.LEAD) {\n    throw new Error(\"lead plane should be first\")\n  }\n  const LEAD_ID = 0\n\n  //slotted[planeId] = array of slot indexes for plane planeId\n  const slotted = planes.map(() => [] as number[])\n\n  // ### rule based slotting ###\n  // base in lead f\n\n  const baseScores = (slotId: number, planeId: number) => {\n    if (formation.baseIds.includes(slotId)) {\n      return planeId === LEAD_ID ? 0 : 1000\n    }\n  }\n\n  //todo add superfloat\n\n  // ### end rule based slotting ###\n\n  //using linear assignment problem formulation\n\n  const angleScore = (slotId: number, planeId: number) => {\n    const slot = formation.slots[slotId]\n    const plane = planes[planeId]\n    const slotPosition = slot.position.plus(slot.offset)\n    const diff = Polar.unspin(slotPosition.theta - plane.theta)\n\n    //penalize if component is on other side of jumprun from plane\n    //componentTheta is component angle rotated 90 right\n    // if > pi, right side of jump run. if < pi, left side of jump run\n    const componentTheta = Polar.unspin(slot.offset.theta - PI / 2)\n    const componentPosition =\n      approxeq(componentTheta, 0) || approxeq(componentTheta, PI)\n        ? PlanePosition.LEAD\n        : componentTheta > PI\n        ? PlanePosition.RT\n        : PlanePosition.LT\n\n    const penalty =\n      componentPosition === PlanePosition.LEAD ||\n      plane.position === PlanePosition.LEAD ||\n      componentPosition === plane.position\n        ? 0\n        : PI\n\n    return Math.min(diff, 2 * PI - diff) + penalty\n  }\n\n  //   const distScore = (slotId: number, planeId: number) => {\n  //     const slot = formation.allSlots[slotId]\n  //     const plane = planes[planeId]\n  //     return Math.abs(slot.position.plus(slot.offset).distanceFrom(new Polar(100, plane.theta)))\n  //   }\n\n  const unslotted = range(formation.slots.length)\n  const planeArray = planes.flatMap((plane, planeId) =>\n    (Array(plane.filledSlots) as number[]).fill(planeId)\n  )\n\n  const assignments = lapwrapper(\n    unslotted,\n    planeArray,\n    combineScoreFuns(baseScores)(angleScore)\n  )\n\n  assignments.forEach(([slotId, planeId]) => slotted[planeId].push(slotId))\n\n  return slotted.flatMap((slotIds, planeId) =>\n    slotIds.map(slotId => ({ formationSlotId: slotId, planeId }))\n  )\n}\n","import { connect } from \"react-redux\"\nimport FormationComponent from \"./FormationComponent\"\nimport { getFormation, getPlanes, getAllSlots } from \"../selectors\"\nimport { AppState } from \"../store/reducer\"\nimport { fillFunction, labelFunction } from \"../drawing/slotdatafuns\"\n\nconst mapStateToProps = (state: AppState) => ({\n  formation: getFormation(state),\n  planes: getPlanes(state),\n  slots: getAllSlots(state),\n  viewConfig: state.viewConfig,\n  fill: fillFunction(state.viewConfig.colorBy),\n  label: labelFunction(state.viewConfig.numberBy)\n})\n\nexport default connect(mapStateToProps)(FormationComponent)\n\n// console.log({debounceRender})\n\n// export default connect(\n//     mapStateToProps\n// )(debounceRender.debounceRender(FormationComponent, 100))\n","import React from \"react\"\n\ntype PanelContextType = {\n  expanded: string;\n  setExpanded: (panel: string) => void;\n}\nexport default React.createContext<PanelContextType>({\n  expanded: \"\",\n  setExpanded: (_: String) => {\n    return\n  }\n})\n","import React from \"react\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport { FormControl, InputLabel, Select, MenuItem } from \"@material-ui/core\"\nimport { isMobile } from \"react-device-detect\"\nimport { NumDict } from \"../../formation/interfaces\"\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing.unit,\n    minWidth: 180\n  }\n}))\n\nfunction makeOpts(opts: number[], desc?: NumDict<string>) {\n  return opts.map(opt =>\n    isMobile ? (\n      <option key={opt} value={opt}>\n        {desc ? desc[opt] : opt}\n      </option>\n    ) : (\n      <MenuItem key={opt} value={opt}>\n        {desc ? desc[opt] : opt}\n      </MenuItem>\n    )\n  )\n}\n\ntype Props = {\n  label: string;\n  opts: number[];\n  desc?: NumDict<string>;\n  value: number;\n  onSet: (value: number) => void;\n}\nexport default (props: Props) => {\n  const { label, value, onSet, opts, desc } = props\n  const classes = useStyles()\n  return (\n    <FormControl className={classes.root}>\n      <InputLabel>{label}</InputLabel>\n      <Select\n        value={value}\n        onChange={e => onSet(parseInt(e.target.value))}\n        native={isMobile}\n      >\n        {makeOpts(opts, desc)}\n      </Select>\n    </FormControl>\n  )\n}\n","import ExpansionPanel from \"@material-ui/core/ExpansionPanel\"\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\"\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\"\nimport Typography from \"@material-ui/core/Typography\"\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport React, { ReactNode, useContext } from \"react\"\nimport PanelContext from \"./PanelContext\"\n\nconst useStyles = makeStyles(theme => ({\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n    flexBasis: \"50%\",\n    flexShrink: 0\n  },\n  secondaryHeading: {\n    fontSize: theme.typography.pxToRem(15),\n    color: theme.palette.text.secondary\n  },\n  form: {\n    display: \"flex\",\n    flexWrap: \"wrap\"\n  },\n  formControl: {\n    margin: theme.spacing.unit,\n    minWidth: 180\n  }\n}))\n\ntype Props = {\n  name: string;\n  heading1: string;\n  heading2: string;\n  children?: ReactNode;\n}\nconst SettingsPanel = (props: Props) => {\n  const classes = useStyles()\n  const { name, children, heading1, heading2 } = props\n  const { expanded, setExpanded } = useContext(PanelContext)\n  const handleChange = (event: React.ChangeEvent<{}>, isExpanded: boolean) => {\n    setExpanded(isExpanded ? name : \"\")\n  }\n\n  return (\n    <ExpansionPanel expanded={expanded === name} onChange={handleChange} square>\n      <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n        <Typography className={classes.heading}>{heading1}</Typography>\n        <Typography className={classes.secondaryHeading}>{heading2}</Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <form className={classes.form} autoComplete=\"off\">\n          {children}\n        </form>\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  )\n}\n\nexport default SettingsPanel\n","import { FormControl, Typography } from \"@material-ui/core\"\nimport Slider from \"@material-ui/lab/Slider\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport * as d3 from \"d3\"\nimport React, { Dispatch } from \"react\"\nimport { isMobile } from \"react-device-detect\"\nimport { connect } from \"react-redux\"\nimport getSlotOptions, { SlotOptions } from \"../../selectors/getSlotOptions\"\nimport {\n  baseSize,\n  formationSlots,\n  setFormationType\n} from \"../../store/actions\"\nimport { AppState } from \"../../store/reducer\"\nimport { FormationConfigActionTypes, FormationType } from \"../../store/types\"\nimport Select from \"./Select\"\nimport SettingsPanel from \"./SettingsPanel\"\n\nconst useStyles = makeStyles(theme => ({\n  slots: {\n    display: \"flex\",\n    alignItems: \"center\"\n  },\n  slider: {\n    paddingLeft: theme.spacing.unit,\n    paddingRight: theme.spacing.unit\n  },\n  formControl: {\n    margin: theme.spacing.unit,\n    minWidth: 180\n  }\n}))\n\nconst formationTypeDesc = {\n  [FormationType.HD]: \"Head Down (from below)\",\n  [FormationType.HD_ABOVE]: \"Head Down (from above)\",\n  [FormationType.HU]: \"Head Up (from above)\"\n}\n\ntype Props = {\n  slotsOptions: SlotOptions;\n  baseSize: number;\n  formationType: FormationType;\n  onFormationSlotsSet: (slots: number) => void;\n  onBaseSizeSet: (size: number) => void;\n  onSetFormationType: (formationType: FormationType) => void;\n}\nconst Slots: React.FunctionComponent<Props> = (props: Props) => {\n  const {\n    slotsOptions: { min, max, slots },\n    baseSize,\n    formationType,\n    onFormationSlotsSet,\n    onBaseSizeSet,\n    onSetFormationType\n  } = props\n\n  const classes = useStyles()\n\n  const baseSizes = [4, 6, 8, 10]\n  const slotItems = d3.range(min, max)\n  const formationTypes = [\n    FormationType.HD,\n    FormationType.HD_ABOVE,\n    FormationType.HU\n  ]\n\n  const slotForm = isMobile ? (\n    <Select\n      label=\"Slots\"\n      value={slots}\n      opts={slotItems}\n      onSet={onFormationSlotsSet}\n    />\n  ) : (\n    <FormControl className={classes.formControl}>\n      <Typography variant=\"caption\" gutterBottom>\n        Slots\n      </Typography>\n      <div className={classes.slots}>\n        <Typography>{min}</Typography>\n        <Slider\n          min={min}\n          max={max}\n          value={slots}\n          step={1}\n          className={classes.slider}\n          onChange={(_, value) => onFormationSlotsSet(value)}\n        />\n        <Typography>{max}</Typography>\n      </div>\n    </FormControl>\n  )\n\n  return (\n    <React.Fragment>\n      <SettingsPanel name=\"slots\" heading1=\"Slots\" heading2={slots.toString()}>\n        {slotForm}\n      </SettingsPanel>\n      <SettingsPanel\n        name=\"baseSize\"\n        heading1=\"BaseSize\"\n        heading2={baseSize.toString()}\n      >\n        <Select\n          label=\"Base Size\"\n          value={baseSize}\n          opts={baseSizes}\n          onSet={onBaseSizeSet}\n        />\n      </SettingsPanel>\n      <SettingsPanel\n        name=\"formationType\"\n        heading1=\"Formation Type\"\n        heading2={formationTypeDesc[formationType]}\n      >\n        <Select\n          label=\"Formation Type\"\n          value={formationType}\n          opts={formationTypes}\n          desc={formationTypeDesc}\n          onSet={onSetFormationType}\n        />\n      </SettingsPanel>\n    </React.Fragment>\n  )\n}\n\nconst mapStateToProps = (state: AppState) => ({\n  slotsOptions: getSlotOptions(state),\n  baseSize: state.formationConfig.baseSize,\n  formationType: state.formationConfig.type\n})\n\nconst mapDispatchToProps = (\n  dispatch: Dispatch<FormationConfigActionTypes>\n) => ({\n  onFormationSlotsSet: (slots: number) => dispatch(formationSlots(slots)),\n  onBaseSizeSet: (size: number) => dispatch(baseSize(size)),\n  onSetFormationType: (type: FormationType) => dispatch(setFormationType(type))\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Slots)\n","import {\n  SET_BASE_SIZE,\n  SET_FORMATION_SLOTS,\n  SET_FORMATION_TYPE,\n  SET_PLANE_SLOTTING,\n  SET_PLANE_TYPE,\n  SET_PLANE_SLOTS,\n  SET_COLOR_BY,\n  SET_NUMBER_BY,\n  ColorOption,\n  NumberOption,\n  PlaneType,\n  Slotting,\n  FormationType,\n  FormationConfigActionTypes,\n  PlanesConfigActionTypes,\n  ViewConfigActionTypes,\n  ShowOption,\n  SET_SHOW,\n  REFRESH_STATE,\n  RefreshStateAction,\n  SET_PLANE_VIDEO\n} from \"./types\"\nimport PlanePosition from \"../formation/PlanePosition\"\n\nexport const baseSize = (baseSize: number): FormationConfigActionTypes => ({\n  type: SET_BASE_SIZE,\n  baseSize\n})\n\nexport const formationSlots = (slots: number): FormationConfigActionTypes => ({\n  type: SET_FORMATION_SLOTS,\n  slots\n})\n\nexport const setFormationType = (\n  formationType: FormationType\n): FormationConfigActionTypes => ({\n  type: SET_FORMATION_TYPE,\n  formationType\n})\n\nexport const setPlaneSlotting = (\n  position: PlanePosition,\n  slotting: Slotting\n): PlanesConfigActionTypes => ({\n  type: SET_PLANE_SLOTTING,\n  position,\n  slotting\n})\n\nexport const setPlaneType = (\n  position: PlanePosition,\n  type: PlaneType\n): PlanesConfigActionTypes => ({\n  type: SET_PLANE_TYPE,\n  position,\n  planeType: type\n})\n\nexport const setPlaneSlots = (\n  position: PlanePosition,\n  slots: number\n): PlanesConfigActionTypes => ({\n  type: SET_PLANE_SLOTS,\n  position,\n  slots\n})\n\nexport const setPlaneVideo = (\n  position: PlanePosition,\n  hasVideo: boolean\n): PlanesConfigActionTypes => ({\n  type: SET_PLANE_VIDEO,\n  position,\n  hasVideo\n})\n\nexport const setColorBy = (colorBy: ColorOption): ViewConfigActionTypes => ({\n  type: SET_COLOR_BY,\n  colorBy\n})\n\nexport const setNumberBy = (numberBy: NumberOption): ViewConfigActionTypes => ({\n  type: SET_NUMBER_BY,\n  numberBy\n})\n\nexport const setShow = (show: ShowOption): ViewConfigActionTypes => ({\n  type: SET_SHOW,\n  show\n})\n\nexport const refreshState = (): RefreshStateAction => ({ type: REFRESH_STATE })\n","import * as d3 from \"d3\"\nimport React, { Dispatch } from \"react\"\nimport { connect } from \"react-redux\"\nimport PlanePosition from \"../../formation/PlanePosition\"\nimport {\n  setPlaneSlots,\n  setPlaneSlotting,\n  setPlaneType,\n  setPlaneVideo\n} from \"../../store/actions\"\nimport { AppState } from \"../../store/reducer\"\nimport {\n  PlanesConfigActionTypes,\n  PlaneState,\n  PlaneType,\n  Slotting\n} from \"../../store/types\"\nimport Select from \"./Select\"\nimport SettingsPanel from \"./SettingsPanel\"\nimport { FormControlLabel, Switch } from \"@material-ui/core\"\n\ntype Setters = {\n  onPlaneTypeSet: (plane: PlanePosition, type: PlaneType) => void;\n  onPlaneSlotsSet: (plane: PlanePosition, slots: number) => void;\n  onPlaneSlottingSet: (plane: PlanePosition, slotting: Slotting) => void;\n  onPlaneVideoSet: (plane: PlanePosition, hasVideo: boolean) => void;\n}\n\ntype PlaneMenuProps = {\n  planeConfig: PlaneState;\n  setters: Setters;\n}\n\nconst typeDescriptions = {\n  [PlaneType.OTTER]: \"Otter\",\n  [PlaneType.SKYVAN]: \"Skyvan\",\n  [PlaneType.NONE]: \"None\"\n}\n\nconst PlaneMenu = (props: PlaneMenuProps) => {\n  const { planeConfig, setters } = props\n  const { position, label, slotting, type, slots, hasVideo } = planeConfig\n  const {\n    onPlaneSlottingSet,\n    onPlaneTypeSet,\n    onPlaneSlotsSet,\n    onPlaneVideoSet\n  } = setters\n\n  const types =\n    position === PlanePosition.LEAD\n      ? [PlaneType.OTTER, PlaneType.SKYVAN]\n      : [PlaneType.OTTER, PlaneType.SKYVAN, PlaneType.NONE]\n\n  const { FILL, SPLIT } = Slotting\n  const slottingDescriptions = {\n    [FILL]: \"Fill plane\",\n    [SPLIT]: \"Split evenly\"\n  }\n  const slottings = [SPLIT, FILL]\n\n  return (\n    <SettingsPanel\n      name={label}\n      heading1={label}\n      heading2={typeDescriptions[type]}\n    >\n      <Select\n        label=\"Type\"\n        value={type}\n        opts={types}\n        desc={typeDescriptions}\n        onSet={(t: number) => onPlaneTypeSet(position, t)}\n      />\n      <Select\n        label=\"Slots\"\n        value={slots}\n        opts={d3.range(1, 31)}\n        onSet={(s: number) => onPlaneSlotsSet(position, s)}\n      />\n      <Select\n        label=\"Slotting\"\n        value={slotting}\n        opts={slottings}\n        desc={slottingDescriptions}\n        onSet={(s: number) => onPlaneSlottingSet(position, s)}\n      />\n      <FormControlLabel\n        control={\n          <Switch\n            checked={hasVideo}\n            onChange={() => onPlaneVideoSet(position, !hasVideo)}\n            color=\"primary\"\n          />\n        }\n        label=\"Video\"\n      />\n    </SettingsPanel>\n  )\n}\n\ntype PlanesProps = {\n  planesConfig: PlaneState[];\n  setters: Setters;\n}\nconst Planes = (props: PlanesProps) => {\n  const { planesConfig, setters } = props\n\n  return (\n    <React.Fragment>\n      {planesConfig.map(planeConfig => (\n        <PlaneMenu\n          key={planeConfig.position}\n          planeConfig={planeConfig}\n          setters={setters}\n        />\n      ))}\n    </React.Fragment>\n  )\n}\n\nconst mapStateToProps = (state: AppState) => ({\n  planesConfig: state.planesConfig\n})\n\nconst mapDispatchToProps = (dispatch: Dispatch<PlanesConfigActionTypes>) => ({\n  setters: {\n    onPlaneTypeSet: (plane: PlanePosition, type: PlaneType) =>\n      dispatch(setPlaneType(plane, type)),\n    onPlaneSlotsSet: (plane: PlanePosition, slots: number) =>\n      dispatch(setPlaneSlots(plane, slots)),\n    onPlaneSlottingSet: (plane: PlanePosition, slotting: Slotting) =>\n      dispatch(setPlaneSlotting(plane, slotting)),\n    onPlaneVideoSet: (plane: PlanePosition, hasVideo: boolean) =>\n      dispatch(setPlaneVideo(plane, hasVideo))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Planes)\n","import React, { Dispatch } from \"react\"\nimport { connect } from \"react-redux\"\nimport {\n  ColorOption,\n  NumberOption,\n  ShowOption,\n  ViewConfigState,\n  ViewConfigActionTypes\n} from \"../../store/types\"\nimport { setColorBy, setNumberBy, setShow } from \"../../store/actions\"\nimport { AppState } from \"../../store/reducer\"\nimport SettingsPanel from \"./SettingsPanel\"\nimport { NumDict } from \"../../formation/interfaces\"\nimport Select from \"./Select\"\n\ntype Props = {\n  viewConfig: ViewConfigState;\n  onSetColorBy: (opt: ColorOption) => void;\n  onSetNumberBy: (opt: NumberOption) => void;\n  onSetShow: (opt: ShowOption) => void;\n}\n\nconst colorBys = [\n  ColorOption.DEFAULT,\n  ColorOption.PLANE,\n  ColorOption.BUILD_ORDER,\n  ColorOption.RADIAL\n]\nconst colorByDesc: NumDict<string> = {\n  [ColorOption.DEFAULT]: \"Default\",\n  [ColorOption.PLANE]: \"Plane\",\n  [ColorOption.BUILD_ORDER]: \"Build Order\",\n  [ColorOption.RADIAL]: \"Radial\"\n}\n\nconst numberBys = [\n  NumberOption.SLOT_NUM,\n  NumberOption.SLOT_NUM_BY_PLANE,\n  NumberOption.BUILD_ORDER\n]\n\nconst numberByDesc: NumDict<string> = {\n  [NumberOption.SLOT_NUM]: \"Slot Number\",\n  [NumberOption.SLOT_NUM_BY_PLANE]: \"Slot Number by Plane\",\n  [NumberOption.BUILD_ORDER]: \"Build Order\"\n}\n\nconst showOptions = [ShowOption.FORMATION, ShowOption.PLANES, ShowOption.BOTH]\n\nconst showOptionDesc: NumDict<string> = {\n  [ShowOption.FORMATION]: \"Formation\",\n  [ShowOption.PLANES]: \"Planes\",\n  [ShowOption.BOTH]: \"Formation & Planes\"\n}\n\nconst View = (props: Props) => {\n  const { viewConfig, onSetColorBy, onSetNumberBy, onSetShow } = props\n\n  return (\n    <React.Fragment>\n      <SettingsPanel\n        name=\"colorby\"\n        heading1=\"Color by\"\n        heading2={colorByDesc[viewConfig.colorBy]}\n      >\n        <Select\n          label=\"Color by\"\n          value={viewConfig.colorBy}\n          opts={colorBys}\n          desc={colorByDesc}\n          onSet={onSetColorBy}\n        />\n      </SettingsPanel>\n      <SettingsPanel\n        name=\"numberby\"\n        heading1=\"Number by\"\n        heading2={numberByDesc[viewConfig.numberBy]}\n      >\n        <Select\n          label=\"Number by\"\n          value={viewConfig.numberBy}\n          opts={numberBys}\n          desc={numberByDesc}\n          onSet={onSetNumberBy}\n        />\n      </SettingsPanel>\n      <SettingsPanel\n        name=\"show\"\n        heading1=\"Show\"\n        heading2={showOptionDesc[viewConfig.show]}\n      >\n        <Select\n          label=\"Show\"\n          value={viewConfig.show}\n          opts={showOptions}\n          desc={showOptionDesc}\n          onSet={onSetShow}\n        />\n      </SettingsPanel>\n    </React.Fragment>\n  )\n}\n\nconst mapStateToProps = (state: AppState) => ({\n  viewConfig: state.viewConfig\n})\n\nconst mapDispatchToProps = (dispatch: Dispatch<ViewConfigActionTypes>) => ({\n  onSetColorBy: (colorBy: ColorOption) => dispatch(setColorBy(colorBy)),\n  onSetNumberBy: (numberBy: NumberOption) => dispatch(setNumberBy(numberBy)),\n  onSetShow: (show: ShowOption) => dispatch(setShow(show))\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(View)\n","import React from \"react\"\nimport PanelContext from \"./PanelContext\"\nimport Slots from \"./Slots\"\nimport Planes from \"./Planes\"\nimport View from \"./View\"\n\nexport default function Panels() {\n  const [expanded, setExpanded] = React.useState<string>(\"\")\n\n  return (\n    <PanelContext.Provider value={{ expanded, setExpanded }}>\n      <div style={{ width: \"100%\" }}>\n        <Slots />\n        <Planes />\n        <View />\n      </div>\n    </PanelContext.Provider>\n  )\n}\n","import AppBar from \"@material-ui/core/AppBar\"\nimport Drawer from \"@material-ui/core/Drawer\"\nimport Hidden from \"@material-ui/core/Hidden\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport SwipeableDrawer from \"@material-ui/core/SwipeableDrawer\"\nimport Toolbar from \"@material-ui/core/Toolbar\"\nimport Typography from \"@material-ui/core/Typography\"\nimport MenuIcon from \"@material-ui/icons/Menu\"\nimport RefreshIcon from \"@material-ui/icons/Refresh\"\n\nimport { makeStyles } from \"@material-ui/styles\"\nimport React from \"react\"\nimport Panels from \"./Panels\"\nimport { RefreshStateAction } from \"../../store/types\"\nimport { Dispatch } from \"redux\"\nimport { refreshState } from \"../../store/actions\"\nimport { connect } from \"react-redux\"\n\nconst drawerWidth = 280\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    height: \"100vh\"\n  },\n  drawer: {\n    [theme.breakpoints.up(\"sm\")]: {\n      width: drawerWidth,\n      flexShrink: 0\n    }\n  },\n  appBar: {\n    marginLeft: drawerWidth,\n    [theme.breakpoints.up(\"sm\")]: {\n      width: `calc(100% - ${drawerWidth}px)`\n    }\n  },\n  menuButton: {\n    marginRight: 20,\n    [theme.breakpoints.up(\"sm\")]: {\n      display: \"none\"\n    }\n  },\n  toolbar: theme.mixins.toolbar,\n  drawerPaper: {\n    width: drawerWidth\n  },\n  heading: {\n    flexGrow: 1\n  },\n  content: {\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"column\"\n  }\n}))\n\ninterface ConfigDrawerProps {\n  contents?: React.ReactNode\n  children?: React.ReactNode\n  onRefreshState: () => void\n}\nconst ConfigDrawer: React.FunctionComponent<ConfigDrawerProps> = (\n  props: ConfigDrawerProps\n) => {\n  const classes = useStyles()\n  const [mobileOpen, setMobileOpen] = React.useState(false)\n\n  function handleDrawerToggle() {\n    setMobileOpen(!mobileOpen)\n  }\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"fixed\" className={classes.appBar}>\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"Open drawer\"\n            onClick={handleDrawerToggle}\n            className={classes.menuButton}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography\n            variant=\"h6\"\n            color=\"inherit\"\n            noWrap\n            className={classes.heading}\n          >\n            Formations\n          </Typography>\n          <IconButton color=\"inherit\" onClick={props.onRefreshState}>\n            <RefreshIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <nav className={classes.drawer}>\n        {/* The implementation can be swapped with js to avoid SEO duplication of links. */}\n        <Hidden smUp implementation=\"css\">\n          <SwipeableDrawer\n            variant=\"temporary\"\n            open={mobileOpen}\n            onOpen={handleDrawerToggle}\n            onClose={handleDrawerToggle}\n            classes={{\n              paper: classes.drawerPaper\n            }}\n            ModalProps={{\n              keepMounted: true // Better open performance on mobile.\n            }}\n          >\n            <div className={classes.toolbar} />\n            <Panels />\n          </SwipeableDrawer>\n        </Hidden>\n        <Hidden xsDown implementation=\"css\">\n          <Drawer\n            classes={{\n              paper: classes.drawerPaper\n            }}\n            variant=\"permanent\"\n            open\n          >\n            <div className={classes.toolbar} />\n            <div />\n            <Panels />\n          </Drawer>\n        </Hidden>\n      </nav>\n      <main className={classes.content}>\n        <div className={classes.toolbar} />\n        {props.children}\n      </main>\n    </div>\n  )\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<RefreshStateAction>) => ({\n  onRefreshState: () => dispatch(refreshState())\n})\n\nexport default connect(\n  null,\n  mapDispatchToProps\n)(ConfigDrawer)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { combineReducers, Reducer, AnyAction } from \"redux\"\nimport PlanePosition from \"../formation/PlanePosition\"\nimport {\n  PlaneState,\n  FormationConfigState,\n  ViewConfigState,\n  Slotting,\n  PlaneType,\n  FormationType,\n  ColorOption,\n  NumberOption,\n  SET_PLANE_SLOTTING,\n  SET_PLANE_SLOTS,\n  SET_PLANE_TYPE,\n  SET_FORMATION_SLOTS,\n  SET_FORMATION_TYPE,\n  SET_COLOR_BY,\n  SET_NUMBER_BY,\n  SET_BASE_SIZE,\n  FormationConfigActionTypes,\n  PlanesConfigActionTypes,\n  ViewConfigActionTypes,\n  SET_SHOW,\n  ShowOption,\n  REFRESH_STATE,\n  SET_PLANE_VIDEO\n} from \"./types\"\n\nconst { LEAD, LT, RT } = PlanePosition\n\nconst initialPlaneState: PlaneState[] = [\n  {\n    position: LEAD,\n    label: \"Lead\",\n    slotting: Slotting.SPLIT,\n    type: PlaneType.SKYVAN,\n    slots: 23,\n    hasSuperFloat: false,\n    hasVideo: true\n  },\n  {\n    position: LT,\n    label: \"Left Trail\",\n    slotting: Slotting.SPLIT,\n    type: PlaneType.NONE,\n    slots: 23,\n    hasSuperFloat: false,\n    hasVideo: false\n  },\n  {\n    position: RT,\n    label: \"Right Trail\",\n    slotting: Slotting.SPLIT,\n    type: PlaneType.OTTER,\n    slots: 23,\n    hasSuperFloat: false,\n    hasVideo: false\n  }\n]\n\nconst planesConfig = (\n  state = initialPlaneState,\n  action: PlanesConfigActionTypes\n): PlaneState[] => {\n  const position = action.position\n  return state.map(p => {\n    if (p.position !== position) {\n      return p\n    }\n    switch (action.type) {\n      case SET_PLANE_SLOTTING:\n        return { ...p, slotting: action.slotting }\n      case SET_PLANE_SLOTS:\n        return { ...p, slots: action.slots }\n      case SET_PLANE_TYPE:\n        return { ...p, type: action.planeType }\n      case SET_PLANE_VIDEO:\n        return { ...p, hasVideo: action.hasVideo }\n      default:\n        return p\n    }\n  })\n}\n\nconst formationConfig = (\n  state = { slots: 45, baseSize: 6, type: FormationType.HU }, //type: FormationType.HD\n  action: FormationConfigActionTypes\n): FormationConfigState => {\n  switch (action.type) {\n    case SET_FORMATION_SLOTS:\n      return { ...state, slots: action.slots }\n    case SET_BASE_SIZE:\n      return { ...state, baseSize: action.baseSize }\n    case SET_FORMATION_TYPE:\n      return { ...state, type: action.formationType }\n    default:\n      return state\n  }\n}\n\nconst viewConfig = (\n  state = {\n    colorBy: ColorOption.PLANE,\n    numberBy: NumberOption.SLOT_NUM_BY_PLANE,\n    show: ShowOption.BOTH\n  },\n  action: ViewConfigActionTypes\n): ViewConfigState => {\n  switch (action.type) {\n    case SET_COLOR_BY:\n      return { ...state, colorBy: action.colorBy }\n    case SET_NUMBER_BY:\n      return { ...state, numberBy: action.numberBy }\n    case SET_SHOW:\n      return { ...state, show: action.show }\n    default:\n      return state\n  }\n}\n\nconst rootReducer = combineReducers({\n  planesConfig,\n  formationConfig,\n  viewConfig\n})\n\nexport type AppState = ReturnType<typeof rootReducer>\n\nconst refreshingReducer: Reducer<AppState, AnyAction> = (state, action) => {\n  switch (action.type) {\n    case REFRESH_STATE:\n      return rootReducer(undefined, action)\n    default:\n      return rootReducer(state, action)\n  }\n}\n\nexport default refreshingReducer\n","import { createStore, applyMiddleware } from \"redux\"\nimport reducer from \"./reducer\"\nimport { composeWithDevTools } from \"redux-devtools-extension\"\nimport * as storage from \"redux-storage\"\nimport createEngine from \"redux-storage-engine-localstorage\"\n\nconst storageReduxer = storage.reducer(reducer)\nconst engine = createEngine(\"redux-state\")\nconst middleware = storage.createMiddleware(engine)\nconst store = createStore(\n  storageReduxer,\n  composeWithDevTools(applyMiddleware(middleware))\n)\nconst load = storage.createLoader(engine)\n// load(store)\n\nexport default () => {\n  return store\n}\n","import \"./bootstrap\"\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport App from \"./components/App\"\nimport * as serviceWorker from \"./serviceWorker\"\nimport CssBaseline from \"@material-ui/core/CssBaseline\"\nimport \"typeface-roboto\"\nimport { createMuiTheme } from \"@material-ui/core\"\nimport { ThemeProvider } from \"@material-ui/styles\"\nimport configureStore from \"./store/configureStore\"\n\nconst theme = createMuiTheme({\n  typography: {\n    useNextVariants: true\n  }\n})\n\nconst store = configureStore()\n\nReactDOM.render(\n  <Provider store={store}>\n    <CssBaseline />\n    <ThemeProvider theme={theme}>\n      <App />\n    </ThemeProvider>\n  </Provider>,\n  document.getElementById(\"root\")\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import React from \"react\"\n\nimport FormationContainer from \"./FormationContainer\"\nimport ConfigDrawer from \"./config/ConfigDrawer\"\n\nexport default () => (\n  <ConfigDrawer>\n    <FormationContainer />\n  </ConfigDrawer>\n)\n"],"sourceRoot":""}